(()=>{var e={};e.id=8386,e.ids=[8386],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},52795:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>_,pages:()=>l,routeModule:()=>p,tree:()=>d}),s(43566),s(23658),s(10468),s(91837);var r=s(23191),n=s(88716),o=s(37922),i=s.n(o),t=s(95231),c={};for(let e in t)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>t[e]);s.d(a,c);let d=["",{children:["entregas",{children:["preparacion",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,43566)),"C:\\Users\\eloym\\Documents\\Fundacion Jalisco\\fj_sistema_gen\\src\\app\\entregas\\preparacion\\page.jsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,23658)),"C:\\Users\\eloym\\Documents\\Fundacion Jalisco\\fj_sistema_gen\\src\\app\\layout.jsx"],loading:[()=>Promise.resolve().then(s.bind(s,10468)),"C:\\Users\\eloym\\Documents\\Fundacion Jalisco\\fj_sistema_gen\\src\\app\\loading.js"],"not-found":[()=>Promise.resolve().then(s.bind(s,91837)),"C:\\Users\\eloym\\Documents\\Fundacion Jalisco\\fj_sistema_gen\\src\\app\\not-found.jsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["C:\\Users\\eloym\\Documents\\Fundacion Jalisco\\fj_sistema_gen\\src\\app\\entregas\\preparacion\\page.jsx"],_="/entregas/preparacion/page",u={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/entregas/preparacion/page",pathname:"/entregas/preparacion",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},36377:(e,a,s)=>{Promise.resolve().then(s.bind(s,41402))},41402:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>k});var r=s(10326),n=s(17577),o=s(85443),i=s.n(o),t=s(35047),c=s(80256),d=s(90434),l=s(65764),_=s(9382),u=s(48036),p=s.n(u),h=s(92786),m=s.n(h);let x=function({value:e,onSelect:a,onUnselect:s,estado:o}){let[i,t]=(0,n.useState)(!1);return r.jsx("div",{children:r.jsx("input",{type:"checkbox",className:m().checkbox,value:e,checked:i,onChange:e=>{let r=e.target.value;i?s(r):a(r),t(!i)}})})},g=function({id:e,productos:a,paquetes:s,total:o,productoEstado:i}){let[t,c]=(0,n.useState)([]),[d,l]=(0,n.useState)([]),_=e=>{let a=d.map(a=>a.produc_id==e?{...a,en_es_produc_estado:"cargado"}:a);l(a),o(a)},u=e=>{let a=d.map(a=>a.produc_id==e?{...a,en_es_produc_estado:"en edici\xf3n"}:a);l(a),o(a)};return(0,r.jsxs)("div",{children:[r.jsx("div",{className:p().header,children:r.jsx("h3",{children:"Productos"})}),(0,r.jsxs)("div",{className:p().titulo,children:[r.jsx("h4",{className:p().nombre,children:"Producto"}),r.jsx("h4",{className:p().existencia,children:"Existencia"}),r.jsx("h4",{className:p().cantidad,children:"cantidad"}),r.jsx("h4",{className:p().checkBox,children:"Listo"})]}),0!=t.length?r.jsx(r.Fragment,{children:t.map((e,a)=>(0,r.jsxs)("div",{className:p().container,children:[r.jsx("div",{className:p().nombre,children:e.produc_nombre}),r.jsx("div",{className:`${p().existencia} ${e.produc_existencias<(e.en_es_produc_cant||e.en_produc_cantidad||e.en_pa_cantidad)&&p().rojo}`,children:e.produc_existencias}),r.jsx("div",{className:p().cantidad,children:e.en_es_produc_cant}),r.jsx("div",{className:p().checkBox,children:r.jsx(x,{estado:e.en_es_produc_estado,value:e.produc_id,onSelect:e=>_(e),onUnselect:e=>u(e)})})]},a))}):r.jsx("div",{className:p().container,children:r.jsx("p",{children:"Cargando..."})}),r.jsx("div",{className:p().fooder})]})};var j=s(26133),v=s.n(j),f=s(72557);let b=function({id:e,lista:a,vehiculosSeleccionados:s,validar:o}){let[i,t]=(0,n.useState)(null),[c,d]=(0,n.useState)(""),[l,_]=(0,n.useState)([]),[u,p]=(0,n.useState)([]),[h,m]=(0,n.useState)([]),[x,g]=(0,n.useState)([]),[j,b]=(0,n.useState)(!1),[N,S]=(0,n.useState)(!1),y=e=>{let a=l.find(a=>a.ve_id==e);m([...h,a]),_(l.filter(a=>a.ve_id!=e)),s([...h,a]),S(!0),b(!1)},P=e=>{_([...l,h.find(a=>a.ve_id==e)]);let a=h.filter(a=>a.ve_id!=e);m(a),s(a),b(!1),N||0==h||S(!0)},w=()=>{b(!0),S(!1)};return(0,r.jsxs)("div",{children:[r.jsx("div",{className:v().header,children:r.jsx("h3",{children:"Vehiculos"})}),(0,r.jsxs)("div",{className:v().container,children:[0!=h.length?r.jsx("div",{children:h.map((e,a)=>(0,r.jsxs)("div",{className:v().vehiculos,children:[(0,r.jsxs)("span",{children:[e.ve_marca," ",e.ve_modelo]}),r.jsx(f.zx,{text:"x",type:"aceptar",onPress:()=>{P(e.ve_id)}})]},a))}):(0,r.jsxs)("div",{children:[r.jsx("label",{className:o?v().validar:"",children:" Seleccionar vehiculo: "}),(0,r.jsxs)("select",{className:`${v().select} ${o?v().validar:""}`,onChange:e=>{y(e.target.value)},children:[r.jsx("option",{value:"ninguno",children:"--ninguno--"}),l&&r.jsx(r.Fragment,{children:l.map((e,a)=>(0,r.jsxs)("option",{value:e.ve_id,children:[e.ve_marca," ",e.ve_modelo]},a))})]})]}),N&&0!=l&&0!=h&&r.jsx("div",{children:r.jsx(f.zx,{text:"agregar otro",type:"aceptar",onPress:()=>{w()}})}),j&&r.jsx("div",{children:0!=l.length&&(0,r.jsxs)("div",{children:[r.jsx("label",{children:"Seleccionar vehiculo: "}),(0,r.jsxs)("select",{className:v().select,onChange:e=>{y(e.target.value)},children:[r.jsx("option",{value:"ninguno",children:"--ninguno--"}),l&&r.jsx(r.Fragment,{children:l.map((e,a)=>(0,r.jsxs)("option",{value:e.ve_id,children:[e.ve_marca," ",e.ve_modelo]},a))})]})]})})]}),r.jsx("div",{className:v().fooder})]})};var N=s(35298),S=s.n(N),y=s(77109),P=s(28428),w=s(81608);let C=e=>{if(null==e)return"A\xfan no se ha programado una fecha de entrega";{let a=new Date(e),s=["Domingo","Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado"][a.getUTCDay()],r=a.getUTCDate(),n=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][a.getUTCMonth()],o=a.getUTCFullYear();return`${s} ${r} de ${n} del ${o}`}},E=e=>{if(null==e)return"Hora no especificada";{let[a,s]=e.split(":");return`${a}:${s}`}},k=function(){let e=(0,t.useSearchParams)(),{data:a,status:s}=(0,y.useSession)(),o=(0,t.useRouter)(),u=e.get("id"),[p,h]=(0,n.useState)(""),[m,x]=(0,n.useState)(!0),[j,v]=(0,n.useState)(!1),[N,k]=(0,n.useState)("A\xfan no se termina de cargar"),[T,V]=(0,n.useState)(null),[z,D]=(0,n.useState)([]),[F,O]=(0,n.useState)([]),[J,L]=(0,n.useState)([]),[$,U]=(0,n.useState)([]),[A,q]=(0,n.useState)([]),[G,M]=(0,n.useState)(!1),[I,R]=(0,n.useState)(!1),[Z,B]=(0,n.useState)(!1),[Q,H]=(0,n.useState)(!1),[W,Y]=(0,n.useState)(!0),[X,K]=(0,n.useState)(!0),[ee,ea]=(0,n.useState)(!0),[es,er]=(0,n.useState)(!0),en=async()=>{if(!W){v(!0);try{if(console.log("Guardando..."),!X&&((await fetch(`/api/entregas/vehiculos/${u}`,{method:"DELETE"})).ok||console.log("No se borraron vehiculos"),0!=A.length)){let e=A.map(e=>({ve_id:Number(e.ve_id),en_id:Number(u)})),a=await fetch("/api/entregas/vehiculos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error("Response is not ok");await a.json()}if(!ee&&((await fetch(`/api/entregas/productos/status/${u}`,{method:"DELETE"})).ok||console.log("No se borraron los productos"),0!=J.length)){let e=J.map(e=>({en_id:Number(u),produc_id:Number(e.produc_id),en_es_produc_estado:e.en_es_produc_estado,en_es_produc_cant:Number(e.en_es_produc_cant)})),a=await fetch("/api/entregas/productos/status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error("Response is not ok");await a.json()}if(!es&&((await fetch(`/api/entregas/empleados/${u}`,{method:"DELETE"})).ok||console.log("No se borraron los empleados"),0!=$.length)){let e=$.map(e=>({en_id:Number(u),emp_id:Number(e.emp_id)})),a=await fetch("/api/entregas/empleados",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error("Response is not ok");await a.json()}Y(!0),v(!1),console.log("Guardado")}catch(e){console.log(e),h(e)}}},eo=()=>{if(0!=$.length&&0!=A.length&&0!=J.length)return!J.some(e=>"en edici\xf3n"===e.en_es_produc_estado)||(k("A\xfan no se termina de cargar"),!1);switch(!0){case 0===$.length:k("No se agregaron empleados");break;case 0===A.length:k("No se agregaron vehiculos");break;case 0===J.length:k("A\xfan no se termina de cargar")}return!1},ei=()=>{!0===eo()?B(!0):H(!0)},et=async()=>{if(W){let e=J.map(e=>{let a=new Date;return{produc_id:e.produc_id,hist_estado:"salida",hist_cantidad:e.en_es_produc_cant,hist_precio_ent_sal:e.produc_precio_venta,hist_hora:(0,w.P4)(),hist_dia:a.toISOString().split("T")[0],hist_motivo:"entrega"}});await fetch("/api/inventario/historial/lista",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>{if(!e.ok)throw Error("Response post historia is not ok");return e.json()}),await fetch(`/api/entregas/${u}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({en_estado:"recibir"})}).then(e=>{if(!e.ok)throw Error("Response is not ok");return e.json()}).catch(e=>{h(e)}),await fetch("/api/entregas/productos/removeInventary",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)}),o.push("/entregas")}};return m?r.jsx("div",{className:i().loadingScreen,children:r.jsx(c.Z,{})}):p?r.jsx("div",{className:i().error,children:(0,r.jsxs)("div",{className:i().errorContent,children:[r.jsx(S(),{className:i().textIcon,name:"cloud-offline-outline"}),r.jsx("p",{className:i().textError,children:"No hay Conexi\xf3n"})]})}):(0,r.jsxs)("div",{children:[r.jsx("div",{className:i().navegacion,children:(0,r.jsxs)("h4",{children:[r.jsx(d.default,{href:"/entregas",className:i().link,children:"Entregas"})," ","\\ Preparaci\xf3n \\"," ",T?`${T.cli_municipio}, ${T.cli_estado}.`:"Cargando..."]})}),(0,r.jsxs)("div",{className:i().herramientas,children:[T&&(0,r.jsxs)("p",{children:["Entrega programada para el d\xeda"," ",r.jsx("b",{children:C(T.en_dia_entrega)})," a las"," ",(0,r.jsxs)("b",{children:[E(T.en_hora_entrega)," hrs"]})]}),(0,r.jsxs)("div",{children:[r.jsx(f.zx,{text:"Terminado",type:"",onPress:()=>{ei(),en()}}),r.jsx(f.zx,{text:W?"Guardado":"Guardar",type:"cancelar",onPress:()=>{en()}})]})]}),(0,r.jsxs)("div",{className:i().contenido,children:[r.jsx("div",{className:i().subContenedor1,children:r.jsx(g,{id:u,productos:z,paquetes:F,total:e=>{L(e),Y(!1),ea(!1)},productoEstado:J})}),(0,r.jsxs)("div",{className:i().subContenedor2,children:[r.jsx("div",{className:i().herramientasInfo,children:r.jsx(f.zx,{text:I?(0,r.jsxs)(r.Fragment,{children:[r.jsx("p",{children:"Visualizar"}),r.jsx(S(),{className:i().icon,name:"eye-outline"})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("p",{children:"Ocultar"}),r.jsx(S(),{className:i().icon,name:"eye-off-outline"})]}),type:I?"contenido-light":"contenido-dark",onPress:()=>R(!I)})}),!I&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(l.Z,{municipio:T}),r.jsx(_.Z,{id:u,encargado:T,empleados:$,seleccionados:e=>{U(e),Y(!1),er(!1)}}),r.jsx(b,{lista:A,id:u,vehiculosSeleccionados:e=>{q(e),Y(!1),K(!1)},validar:G})]})]})]}),r.jsx(f.u_,{show:Z,title:"Todo Listo",message:'La entrega se marcara como "recibir", una vez recibida el encargado entregara y validara los datos',handleClose:()=>B(!1),handleAccept:()=>{en(),v(!0),et()}}),r.jsx(f.bZ,{show:Q,title:"Faltan datos",message:N,handleAccept:()=>H(!1)}),r.jsx(P.Z,{show:j})]})}},28428:(e,a,s)=>{"use strict";s.d(a,{Z:()=>i});var r=s(10326),n=s(73730),o=s.n(n);let i=function({show:e}){return r.jsx("div",{className:`${o().modal} ${e?o().show:""}`,children:(0,r.jsxs)("div",{className:o().contenedor,children:[r.jsx("div",{className:o().cuadrado1}),r.jsx("div",{className:o().cuadrado2})]})})}},65764:(e,a,s)=>{"use strict";s.d(a,{Z:()=>i});var r=s(10326),n=s(49895),o=s.n(n);let i=function({municipio:e}){return(0,r.jsxs)("div",{children:[r.jsx("div",{className:o().header,children:r.jsx("h3",{children:"Municipio"})}),r.jsx("div",{className:o().container,children:e?(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[r.jsx("span",{children:"Municipio: "}),e.cli_municipio,", ",e.cli_estado]}),(0,r.jsxs)("p",{children:[r.jsx("span",{children:"Enlace: "}),e.cli_nombre]}),(0,r.jsxs)("p",{children:[r.jsx("span",{children:"Contacto: "}),e.cli_numero_contac]})]}):r.jsx("div",{children:r.jsx("p",{children:"Cargando..."})})}),r.jsx("div",{className:o().fooder})]})}},9382:(e,a,s)=>{"use strict";s.d(a,{Z:()=>c});var r=s(10326),n=s(17577),o=s(29509),i=s.n(o),t=s(72557);let c=function({id:e,encargado:a,empleados:s,seleccionados:o}){let[c,d]=(0,n.useState)([]),[l,_]=(0,n.useState)(""),[u,p]=(0,n.useState)(!0),[h,m]=(0,n.useState)([]),[x,g]=(0,n.useState)([]),j=e=>{if("ninguno"!=e){let a=c.find(a=>a.emp_id==e);m([...h,a]),d(c.filter(a=>a.emp_id!=e)),o([...h,a]),p(!0)}else p(!0)},v=e=>{d([...c,h.find(a=>a.emp_id==e)]);let a=h.filter(a=>a.emp_id!=e);m(a),o(a)};return(0,r.jsxs)("div",{children:[r.jsx("div",{className:i().header,children:r.jsx("h3",{children:"Encargado / Empleados"})}),(0,r.jsxs)("div",{className:i().container,children:[r.jsx("span",{children:a?(0,r.jsxs)("p",{className:i().wrapper,children:[r.jsx("b",{children:"Encargado:"})," ",a.emp_nombre," ",a.emp_apellido]}):r.jsx("p",{children:"Cargando..."})}),s&&(0,r.jsxs)(r.Fragment,{children:[0!=h.length&&r.jsx("div",{className:i().wrapper,children:h.map((e,a)=>(0,r.jsxs)("div",{className:i().nombre,children:[(0,r.jsxs)("p",{children:[r.jsx("b",{children:e.emp_rol}),": ",e.emp_nombre," ",e.emp_apellido]}),r.jsx(t.zx,{text:"x",type:"aceptar",onPress:()=>v(e.emp_id)})]},a))}),0!=c.length&&!u&&(0,r.jsxs)("div",{children:[r.jsx("label",{children:"Empleado: "}),(0,r.jsxs)("select",{className:i().select,onChange:e=>j(e.target.value),children:[r.jsx("option",{value:"ninguno",children:"---ninguno-"}),c.map((e,a)=>(0,r.jsxs)("option",{value:e.emp_id,children:[e.emp_nombre," ",e.emp_apellido," (",e.emp_rol,")"]},a))]})]}),u&&0!=c.length&&r.jsx(t.zx,{text:"A\xf1adir",type:"aceptar",onPress:()=>p(!1)})]})]}),r.jsx("div",{className:i().fooder})]})}},85443:e=>{e.exports={navegacion:"page_navegacion__U2OPx",link:"page_link__hMFSa",herramientas:"page_herramientas__FHW6V",contenido:"page_contenido__VViPR",herramientasInfo:"page_herramientasInfo__AGZHO",icon:"page_icon__oK_0Y",subContenedor1:"page_subContenedor1__uFyFs",subContenedor2:"page_subContenedor2__hm2n3",loadingScreen:"page_loadingScreen__R_yZd",error:"page_error__3YNyl",textIcon:"page_textIcon__Obn_l",textError:"page_textError__RsD_Q",errorContent:"page_errorContent__s9ziS"}},92786:e=>{e.exports={checkbox:"CheckBoxCargado_checkbox__ulVbf"}},49895:e=>{e.exports={header:"InfoMunicipio_header__OrBp7",container:"InfoMunicipio_container__8_QG7",fooder:"InfoMunicipio_fooder__wbG4y"}},29509:e=>{e.exports={header:"SeleccionarEmpleados_header__Onyww",container:"SeleccionarEmpleados_container__azV0F",fooder:"SeleccionarEmpleados_fooder__2cdF1",select:"SeleccionarEmpleados_select__VWJ9_",nombre:"SeleccionarEmpleados_nombre__AXwT9",wrapper:"SeleccionarEmpleados_wrapper__HSreq"}},26133:e=>{e.exports={header:"SeleccionarVehiculos_header__ekmZ_",container:"SeleccionarVehiculos_container__2ilQI",fooder:"SeleccionarVehiculos_fooder___b_Pp",vehiculos:"SeleccionarVehiculos_vehiculos___U0OJ",select:"SeleccionarVehiculos_select__NgcgZ",validar:"SeleccionarVehiculos_validar__12Lok"}},48036:e=>{e.exports={header:"TablaVisualizarProductos_header__olBRc",titulo:"TablaVisualizarProductos_titulo__0cmNy",container:"TablaVisualizarProductos_container__LR_lL",fooder:"TablaVisualizarProductos_fooder__IWN3x",nombre:"TablaVisualizarProductos_nombre__dzLQi",existencia:"TablaVisualizarProductos_existencia__ZUwY_",cantidad:"TablaVisualizarProductos_cantidad__JUlQn",checkBox:"TablaVisualizarProductos_checkBox__Ncvtu",rojo:"TablaVisualizarProductos_rojo__hVNym"}},73730:e=>{e.exports={cuadrado1:"LoadingData_cuadrado1__x1QGj",cuadrado2:"LoadingData_cuadrado2__hOwqp",moverCuadrado1:"LoadingData_moverCuadrado1__vWwXS",moverCuadrado2:"LoadingData_moverCuadrado2__gm3Qs",modal:"LoadingData_modal__Rqj2p",show:"LoadingData_show__jLq8l"}},43566:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`C:\Users\eloym\Documents\Fundacion Jalisco\fj_sistema_gen\src\app\entregas\preparacion\page.jsx#default`)}};var a=require("../../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),r=a.X(0,[8948,1404,434,4424],()=>s(52795));module.exports=r})();