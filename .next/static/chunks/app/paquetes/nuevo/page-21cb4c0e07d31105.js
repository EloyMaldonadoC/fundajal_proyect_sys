(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6172],{8696:function(e,a,o){Promise.resolve().then(o.bind(o,6709))},6709:function(e,a,o){"use strict";o.r(a);var s=o(7437),n=o(2265),t=o(6578),d=o.n(t),r=o(7648),c=o(9376),i=o(4868),l=o(8116),u=o(605),p=o(9172);function _(e){let{producto:a,addProductList:o,deleteProductList:t,changeValue:r,incialiced:c}=e,[l,u]=(0,n.useState)(1);return(0,s.jsxs)("div",{className:d().tablaContenido,children:[(0,s.jsx)("p",{className:d().celda,children:a.produc_nombre}),(0,s.jsxs)("p",{className:d().celda,children:["$",a.produc_precio_venta]}),(0,s.jsx)("div",{className:d().celda,children:(0,s.jsx)("input",{type:"number",min:1,className:d().input,value:l,onChange:e=>{u(e.target.value),r(a.produc_id,e.target.value)}})}),(0,s.jsx)("span",{className:d().checkbox,children:(0,s.jsx)(i.Jg,{value:a.produc_id,onSelect:()=>{o(a.produc_id,l)},onUnselect:()=>{t(a.produc_id)},inicialiced:c})})]},a.produc_id)}a.default=function(){let{data:e,status:a}=(0,u.useSession)(),o=(0,c.useRouter)(),[t,h]=(0,n.useState)(null),[m,x]=(0,n.useState)(""),[g,j]=(0,n.useState)(!1),[v,N]=(0,n.useState)(!1),[f,b]=(0,n.useState)(null),[S,C]=(0,n.useState)(""),[w,k]=(0,n.useState)(!1),[L,P]=(0,n.useState)(""),[q,y]=(0,n.useState)(!1),[E,D]=(0,n.useState)(""),[I,z]=(0,n.useState)(!1),[O,A]=(0,n.useState)(""),[T,J]=(0,n.useState)(!1),[Z,F]=(0,n.useState)(""),[Q,R]=(0,n.useState)(null),[B,H]=(0,n.useState)([]);(0,n.useEffect)(()=>{"Administrador"===e.user.role?fetch("/api/productos").then(e=>{if(!e.ok)throw Error("Response is not ok");return e.json()}).then(e=>{R(e),M(),console.log(e)}).catch(e=>{h(!1),x(e)}):o.push("/")},[o]);let M=()=>{b(Math.floor(1e6+9e7*Math.random()))},U=(e,a)=>{console.log(e),H([...B,{pa_id:f,produc_id:e,produc_pa_cantidad:a}])},V=e=>{console.log(e),H(B.filter(a=>a.produc_id!==e))},W=(e,a)=>{console.log(e,a),H(B.map(o=>(o.produc_id===e&&(o.produc_pa_cantidad=a),o)))},Y=async()=>{try{if(!(await fetch("/api/paquetes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pa_id:f,pa_nombre:S,pa_descripcion:L,pa_precio:E,pa_comision:O})})).ok)throw Error("Network response was not ok");await fetch("/api/paquetes/productos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)}).then(e=>{if(!e.ok)throw Error("Network response was not ok");return N(!1),o.push("/paquetes"),e.json()})}catch(e){x(e),h(!1)}};return t?(0,s.jsx)(l.Z,{}):m?(0,s.jsxs)("p",{children:["Error: ",m.message]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:d().navegacion,children:(0,s.jsxs)("h4",{children:[(0,s.jsx)(r.default,{href:"/paquetes",className:d().link,children:"Paquetes"})," ","\\ Nuevo"]})}),(0,s.jsxs)("div",{className:d().contenedor,children:[(0,s.jsxs)("div",{className:d().formulario,children:[(0,s.jsx)("div",{children:(0,s.jsx)("h3",{children:"Informaci\xf3n del paquete"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.II,{placeholder:"Nombre",value:S,type:"text",onChange:e=>{C(e)},validation:w}),(0,s.jsx)(i.II,{placeholder:"Descripci\xf3n",value:L,type:"text",onChange:e=>{P(e)},validation:q}),(0,s.jsx)(i.II,{placeholder:"Precio",value:E,type:"number",onChange:e=>{D(e)},validation:I}),(0,s.jsx)(i.II,{placeholder:"Comisi\xf3n",value:O,type:"number",onChange:e=>{A(e)},validation:T})]})]}),(0,s.jsxs)("div",{className:d().herramientas,children:[(0,s.jsx)(i.ol,{placeholder:"Buscar producto",onSearch:e=>{F(e)}}),(0,s.jsx)(i.zx,{text:"Aceptar",type:"cancelar",onPress:()=>{""==S?k(!0):k(!1),""==L?y(!0):y(!1),E<=0?z(!0):z(!1),O<=0?J(!0):J(!1),""!=S&&""!=L&&E>0&&0!=B.length&&O>0&&(k(!1),y(!1),z(!1),N(!0))}})]}),(0,s.jsxs)("div",{className:d().tabla,children:[(0,s.jsxs)("div",{className:d().tablaEncabezado,children:[(0,s.jsx)("h3",{className:d().celda,children:"Nombre"}),(0,s.jsx)("h3",{className:d().celda,children:"Precio"}),(0,s.jsx)("h3",{className:d().celda,children:"Cantidad"}),(0,s.jsx)("h3",{className:d().checkbox,children:"Elegir"})]}),Q&&(0,s.jsx)(s.Fragment,{children:Q.map((e,a)=>(0,s.jsx)("div",{children:e.produc_nombre.toLowerCase().includes(Z.toLowerCase())&&(0,s.jsx)(_,{producto:e,addProductList:(e,a)=>U(e,a),deleteProductList:e=>V(e),incialiced:B,changeValue:(e,a)=>W(e,a)})},a))}),(0,s.jsx)("div",{className:d().tablaPiedePagina})]})]}),(0,s.jsx)(i.u_,{show:v,title:"Agregar nuevo paquete",message:"\xbfDeseas agregar el nuevo paquete y todos sus productos seleccionados?",handleAccept:()=>{Y(),j(!0)},handleClose:()=>{N(!1)}}),(0,s.jsx)(p.Z,{show:g})]})}},9172:function(e,a,o){"use strict";var s=o(7437),n=o(6660),t=o.n(n);a.Z=function(e){let{show:a}=e;return(0,s.jsx)("div",{className:"".concat(t().modal," ").concat(a?t().show:""),children:(0,s.jsxs)("div",{className:t().contenedor,children:[(0,s.jsx)("div",{className:t().cuadrado1}),(0,s.jsx)("div",{className:t().cuadrado2})]})})}},8116:function(e,a,o){"use strict";o.d(a,{Z:function(){return d}});var s=o(7437);o(2265);var n=o(6065),t=o.n(n);function d(){return(0,s.jsxs)("div",{className:t().contenedor,children:[(0,s.jsx)("div",{className:t().cuadrado1}),(0,s.jsx)("div",{className:t().cuadrado2})]})}},6578:function(e){e.exports={navegacion:"page_navegacion__c3O8D",link:"page_link__07sLq",herramientas:"page_herramientas__qqqBb",contenedor:"page_contenedor__J8Yz7",formulario:"page_formulario__l2ccS",tabla:"page_tabla__jxmID",tablaEncabezado:"page_tablaEncabezado__1z8xo",input:"page_input__QcF9Y",celda:"page_celda__TFDzn",checkbox:"page_checkbox__UfNu4",tablaContenido:"page_tablaContenido__NHnNi",tablaPiedePagina:"page_tablaPiedePagina__8nWsw"}},6660:function(e){e.exports={cuadrado1:"LoadingData_cuadrado1__x1QGj",cuadrado2:"LoadingData_cuadrado2__hOwqp",moverCuadrado1:"LoadingData_moverCuadrado1__vWwXS",moverCuadrado2:"LoadingData_moverCuadrado2__gm3Qs",modal:"LoadingData_modal__Rqj2p",show:"LoadingData_show__jLq8l"}},6065:function(e){e.exports={cuadrado1:"LoadingScreen_cuadrado1__7A200",cuadrado2:"LoadingScreen_cuadrado2__NNxpH",moverCuadrado1:"LoadingScreen_moverCuadrado1__8i1jV",moverCuadrado2:"LoadingScreen_moverCuadrado2__pz35P"}}},function(e){e.O(0,[6050,7123,1316,8153,6307,7648,4868,2971,2117,1744],function(){return e(e.s=8696)}),_N_E=e.O()}]);