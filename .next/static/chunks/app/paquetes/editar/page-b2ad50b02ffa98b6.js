(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1676],{3920:function(e,a,o){Promise.resolve().then(o.bind(o,9503))},9503:function(e,a,o){"use strict";o.r(a);var t=o(7437),n=o(2265),s=o(7954),c=o.n(s),r=o(7648),i=o(9376),d=o(4868),l=o(8116),u=o(605);function p(e){let{producto:a,addProductList:o,deleteProductList:s,changeValue:r,incialiced:i}=e,l=i.find(e=>e.produc_id==a.produc_id),[u,p]=(0,n.useState)(1);return(0,n.useEffect)(()=>{l&&p(l.produc_pa_cantidad)},[l]),(0,t.jsxs)("div",{className:c().tablaContenido,children:[(0,t.jsx)("p",{className:c().celda,children:a.produc_nombre}),(0,t.jsxs)("p",{className:c().celda,children:["$",a.produc_precio_venta]}),(0,t.jsx)("div",{className:c().celda,children:(0,t.jsx)("input",{type:"number",min:1,className:c().input,value:u,onChange:e=>{p(e.target.value),r(a.produc_id,e.target.value)}})}),(0,t.jsx)("span",{className:c().checkbox,children:(0,t.jsx)(d.Jg,{value:a.produc_id,onSelect:()=>{o(a.produc_id)},onUnselect:()=>{s(a.produc_id)},inicialiced:i})})]},a.produc_id)}a.default=function(){let{data:e,status:a}=(0,u.useSession)(),o=(0,i.useSearchParams)(),s=(0,i.useRouter)(),h=o.get("id"),[_,m]=(0,n.useState)(null),[x,g]=(0,n.useState)(""),[j,f]=(0,n.useState)(!1),[v,b]=(0,n.useState)(""),[N,S]=(0,n.useState)(!1),[k,E]=(0,n.useState)(""),[C,P]=(0,n.useState)(!1),[y,q]=(0,n.useState)(""),[w,L]=(0,n.useState)(!1),[I,A]=(0,n.useState)(""),[O,z]=(0,n.useState)(null),[U,T]=(0,n.useState)([]);(0,n.useEffect)(()=>{"Administrador"===e.user.role?(fetch("/api/paquetes/".concat(h)).then(e=>{if(!e.ok)throw Error("Response is not ok");return e.json()}).then(e=>{b(e.pa_nombre),E(e.pa_descripcion),q(e.pa_precio)}).catch(e=>{m(!1),g(e)}),fetch("/api/productos").then(e=>{if(!e.ok)throw Error("Response is not ok");return e.json()}).then(e=>{z(e)}).catch(e=>{m(!1),g(e)}),fetch("/api/paquetes/productos/".concat(h)).then(e=>{if(e.ok)return e.json()}).then(e=>{console.log(e),T(e),console.log(e)}).catch(e=>{g(e),m(!1)})):s.push("/paquetes")},[h,s]);let D=(e,a)=>{console.log(e,a),T([...U,{pa_id:h,produc_id:e,produc_pa_cantidad:a}])},R=e=>{console.log(e),T(U.filter(a=>a.produc_id!==e))},V=async()=>{try{(await fetch("/api/paquetes/productos/".concat(h),{method:"DELETE"})).ok||console.log("No se borro"),await fetch("/api/paquetes/productos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)}).then(e=>{if(!e.ok)throw Error("Network response was not ok");return f(!1),s.push("/paquetes"),e.json()}),await fetch("/api/paquetes/".concat(h),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({pa_nombre:v,pa_descripcion:k,pa_precio:y})}).then(e=>{if(!e.ok)throw Error("Response is not ok");return e.json()})}catch(e){g(e),m(!1)}},H=(e,a)=>{console.log(e,a),T(U.map(o=>(o.produc_id===e&&(o.produc_pa_cantidad=a),o)))};return _?(0,t.jsx)(l.Z,{}):x?(0,t.jsxs)("p",{children:["Error: ",x.message]}):(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:c().navegacion,children:(0,t.jsxs)("h4",{children:[(0,t.jsx)(r.default,{href:"/paquetes",className:c().link,children:"Paquetes"})," ","\\ Editar"]})}),(0,t.jsxs)("div",{className:c().contenedor,children:[(0,t.jsxs)("div",{className:c().formulario,children:[(0,t.jsx)("div",{children:(0,t.jsx)("h3",{children:"Informacion del paquete"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(d.II,{placeholder:"Nombre",value:v,type:"text",onChange:e=>{b(e)},validation:N}),(0,t.jsx)(d.II,{placeholder:"Descripci\xf3n",value:k,type:"text",onChange:e=>{E(e)},validation:C}),(0,t.jsx)(d.II,{placeholder:"Precio",value:y,type:"number",onChange:e=>{q(e)},validation:w})]})]}),(0,t.jsxs)("div",{className:c().herramientas,children:[(0,t.jsx)(d.ol,{placeholder:"Buscar producto",onSearch:e=>{A(e)}}),(0,t.jsx)(d.zx,{text:"Aceptar",type:"cancelar",onPress:()=>{""==v?S(!0):S(!1),""==k?P(!0):P(!1),y<=0?L(!0):L(!1),""!=v&&""!=k&&y>0&&0!=U.length&&(S(!1),P(!1),L(!1),f(!0))}})]}),(0,t.jsxs)("div",{className:c().tabla,children:[(0,t.jsxs)("div",{className:c().tablaEncabezado,children:[(0,t.jsx)("h3",{className:c().celda,children:"Nombre"}),(0,t.jsx)("h3",{className:c().celda,children:"Precio"}),(0,t.jsx)("h3",{className:c().checkbox,children:"Elegir"})]}),O&&(0,t.jsx)(t.Fragment,{children:O.map((e,a)=>(0,t.jsx)("div",{children:e.produc_nombre.toLowerCase().includes(I.toLowerCase())&&(0,t.jsx)(p,{producto:e,addProductList:(e,a)=>D(e,a),deleteProductList:e=>R(e),changeValue:H,incialiced:U})},a))}),(0,t.jsx)("div",{className:c().tablaPiedePagina})]})]}),(0,t.jsx)(d.u_,{title:"Editar el Paquete",message:"\xbfQuieres editar el contenido del paquete?",show:j,handleClose:()=>{f(!1)},handleAccept:()=>{V()}})]})}},8116:function(e,a,o){"use strict";o.d(a,{Z:function(){return c}});var t=o(7437);o(2265);var n=o(6065),s=o.n(n);function c(){return(0,t.jsxs)("div",{className:s().contenedor,children:[(0,t.jsx)("div",{className:s().cuadrado1}),(0,t.jsx)("div",{className:s().cuadrado2})]})}},7954:function(e){e.exports={navegacion:"page_navegacion__AEigs",link:"page_link__vI04p",contenedor:"page_contenedor__yUK89",formulario:"page_formulario__9Hqgt",herramientas:"page_herramientas__lv2LU",tabla:"page_tabla__CZMfj",tablaEncabezado:"page_tablaEncabezado___3SKO",input:"page_input__WzrOb",celda:"page_celda__VemDI",checkbox:"page_checkbox__ADVKs",tablaContenido:"page_tablaContenido__5AUsU",tablaPiedePagina:"page_tablaPiedePagina__4yHNq"}},6065:function(e){e.exports={cuadrado1:"LoadingScreen_cuadrado1__7A200",cuadrado2:"LoadingScreen_cuadrado2__NNxpH",moverCuadrado1:"LoadingScreen_moverCuadrado1__8i1jV",moverCuadrado2:"LoadingScreen_moverCuadrado2__pz35P"}}},function(e){e.O(0,[4948,7123,1316,8153,6307,7648,4868,2971,2117,1744],function(){return e(e.s=3920)}),_N_E=e.O()}]);