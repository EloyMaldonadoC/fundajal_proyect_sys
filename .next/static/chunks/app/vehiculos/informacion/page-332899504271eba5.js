(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7097],{492:function(e,a,s){Promise.resolve().then(s.bind(s,4806))},4806:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return j}});var n=s(7437),t=s(2265),i=s(9144),o=s.n(i),c=s(9376),r=s(7648),l=s(8116),d=s(4868),_=s(4067),u=s(7921),h=s.n(u),p=function(e){let{id:a}=e,[s,i]=(0,t.useState)(null),[o,c]=(0,t.useState)(""),[r,_]=(0,t.useState)(!1),[u,p]=(0,t.useState)(!1),[v,x]=(0,t.useState)("Todos"),[g,m]=(0,t.useState)(!1),[j,f]=(0,t.useState)(null),[S,N]=(0,t.useState)("pendiente"),[b,C]=(0,t.useState)(""),[y,k]=(0,t.useState)(""),[P,E]=(0,t.useState)(""),[z,w]=(0,t.useState)(""),[T,I]=(0,t.useState)(""),[O,V]=(0,t.useState)(""),[D,A]=(0,t.useState)(!1),[F,M]=(0,t.useState)(!1),[R,Z]=(0,t.useState)(!1);(0,t.useEffect)(()=>{fetch("/api/vehiculos/servicios/".concat(a)).then(e=>{if(e.ok)return e.json()}).then(e=>{f(e),console.log(e)}).catch(e=>{c(e),i(!1)})},[a,r]);let H=()=>{console.log("Todos"),fetch("/api/vehiculos/servicios/".concat(a)).then(e=>{if(e.ok)return e.json()}).then(e=>{f(e),console.log(e)}).catch(e=>{c(e),i(!1)}),x("Todos"),m(!1)},Y=async()=>{try{let[e,s]=await Promise.all([fetch("/api/datetime/date"),fetch("/api/datetime/time")]);if(!e.ok||!s.ok)throw Error("Network response was not ok");let n=await e.json(),t=await s.json();E(n.fecha_actual),w(t.hora_actual),console.log(n.fecha_actual),console.log(t.hora_actual),await fetch("/api/vehiculos/servicios",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ve_id:a,ser_estado:S,ser_desc:b,ser_costo:y,ser_fecha_creacion:n.fecha_actual,ser_hora_creacion:t.hora_actual,ser_fecha_realizacion:"",ser_hora_realizacion:""})}).then(e=>{if(!e.ok)throw Error("Network response was not ok");return p(!1),_(!0),C(""),k(""),H(),e.json()}).catch(e=>{c(e),i(!1)})}catch(e){c(e),i(!1)}},J=async e=>{try{let[a,s]=await Promise.all([fetch("/api/datetime/date"),fetch("/api/datetime/time")]);if(!a.ok||!s.ok)throw Error("Network response was not ok");let n=await a.json(),t=await s.json();I(n.fecha_actual),V(t.hora_actual),console.log(n.fecha_actual),console.log(t.hora_actual),await fetch("/api/vehiculos/servicios/servicio/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({ser_estado:"realizado",ser_fecha_realizacion:n.fecha_actual,ser_hora_realizacion:t.hora_actual})}).then(e=>{if(!e.ok)throw Error("network response was not ok");return _(!0),e.json()}).catch(e=>{c(e),i(!1)})}catch(e){c(e),i(!1)}},U=e=>{let a=new Date(e);a.setHours(a.getHours()+a.getTimezoneOffset()/60),console.log(a);let s=String(a.getDate()).padStart(2,"0"),n=String(a.getMonth()+1).padStart(2,"0"),t=a.getFullYear();return"".concat(t,"-").concat(n,"-").concat(s)};return s?(0,n.jsx)(l.Z,{}):o?(0,n.jsxs)("p",{children:["Error: ",o.message]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:h().banner,children:(0,n.jsx)("h3",{children:"Servicios"})}),(0,n.jsxs)("div",{className:h().serviciosMenu,children:[(0,n.jsx)(d.zx,{text:"Todos",type:"Todos"==v?"cancelar":"",onPress:H}),(0,n.jsx)(d.zx,{text:"Pendientes",type:"Pendientes"==v?"cancelar":"",onPress:()=>{console.log("Pendientes"),fetch("/api/vehiculos/servicios/filtro/pendientes/".concat(a)).then(e=>{if(e.ok)return e.json()}).then(e=>{f(e),console.log(e)}).catch(e=>{c(e),i(!1)}),x("Pendientes"),m(!1)}}),(0,n.jsx)(d.zx,{text:"Realizados",type:"Realizados"==v?"cancelar":"",onPress:()=>{console.log("Realizados"),fetch("/api/vehiculos/servicios/filtro/realizados/".concat(a)).then(e=>{if(e.ok)return e.json()}).then(e=>{f(e),console.log(e)}).catch(e=>{c(e),i(!1)}),x("Realizados"),m(!1)}}),(0,n.jsx)(d.zx,{text:"Nuevo",type:"Nuevo"==v?"cancelar":"",onPress:()=>{x("Nuevo"),m(!g)}})]}),g?(0,n.jsxs)("div",{className:h().servicios,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(d.II,{placeholder:"Descripcion",type:"text",value:b,onChange:e=>{C(e)},validation:F}),(0,n.jsx)(d.II,{placeholder:"Costo",type:"number",value:y,onChange:e=>{k(e)},validation:R})]}),(0,n.jsx)(d.zx,{text:"Aceptar",type:"aceptar",onPress:()=>{""==b&&M(!0),y<=0||""==y?Z(!0):(M(!1),Z(!1),p(!0))}})]}):(0,n.jsx)(n.Fragment,{children:j?(0,n.jsx)("div",{children:j.map(e=>(0,n.jsxs)("div",{className:h().servicios,children:[(0,n.jsxs)("h3",{children:["Servicio ",e.ser_estado]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:h().text,children:" Descipci\xf3n: "}),e.ser_desc]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:h().text,children:" Costo: "}),"$",e.ser_costo]}),"realizado"==e.ser_estado&&(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:h().text,children:" Realizado el "}),U(e.ser_fecha_realizacion),(0,n.jsx)("span",{className:h().text,children:" a las "}),e.ser_hora_realizacion]}),"pendiente"==e.ser_estado&&(0,n.jsx)("div",{className:h().espaciado,children:(0,n.jsx)(d.zx,{text:"Marcar como Realizado",type:"aceptar",onPress:()=>{J(e.ser_id)}})})]},e.ser_id))}):(0,n.jsx)("div",{className:h().servicios,children:(0,n.jsx)("p",{className:h().sinServicio,children:"A\xfan no hay servicios"})})}),(0,n.jsx)(d.u_,{title:"Nuevo Servicio",message:"\xbfAgregar nuevo servicio?",show:u,handleClose:()=>{p(!u)},handleAccept:Y})]})},v=s(605),x=s(8999),g=s.n(x);function m(e){let{data:a,onSelect:s,validar:i,text:c,value:r}=e,[l,d]=(0,t.useState)("Optimo");return(0,t.useEffect)(()=>{"Optimo"==r?d("Optimo"):"Revisi\xf3n"==r?d("Revisi\xf3n"):"Fuera de Servicio"==r&&d("Fuera de Servicio")},[r]),(0,n.jsxs)("div",{className:o().containerVe,children:[(0,n.jsx)("p",{children:c}),(0,n.jsx)("select",{value:l,className:"".concat(o().selectVe," ").concat(i?o().validarVe:""),onChange:e=>s(e.target.value),style:{borderColor:i?"red":""},children:a.map(e=>(0,n.jsx)("option",{value:e.nombre,children:e.nombre},e.id))})]})}var j=function(){let{data:e,status:a}=(0,v.useSession)(),s=(0,c.useSearchParams)().get("id"),i=(0,c.useRouter)(),[u,h]=(0,t.useState)(!1),[x,j]=(0,t.useState)(!1),[f,S]=(0,t.useState)(!1),[N,b]=(0,t.useState)(!0),[C,y]=(0,t.useState)(""),[k,P]=(0,t.useState)(""),[E,z]=(0,t.useState)(!1),[w,T]=(0,t.useState)(""),[I,O]=(0,t.useState)(!1),[V,D]=(0,t.useState)(""),[A,F]=(0,t.useState)(!1),[M,R]=(0,t.useState)(""),[Z,H]=(0,t.useState)(""),[Y,J]=(0,t.useState)(""),[U,L]=(0,t.useState)(!1),[G,Q]=(0,t.useState)(""),[W,q]=(0,t.useState)(!1),[B,X]=(0,t.useState)(""),[$,K]=(0,t.useState)(!1),[ee,ea]=(0,t.useState)(""),[es,en]=(0,t.useState)(!1),[et,ei]=(0,t.useState)(""),[eo,ec]=(0,t.useState)(!1),[er,el]=(0,t.useState)(""),[ed,e_]=(0,t.useState)(!1),[eu,eh]=(0,t.useState)(null),[ep,ev]=(0,t.useState)(null);(0,t.useEffect)(()=>{"Administrador"===e.user.role?(fetch("/api/vehiculos/".concat(s)).then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>{ev(e),J(e.ve_agencia),Q(e.ve_capacidad),X(e.ve_propietario),ea(e.ve_entidad),ei(e.ve_placas),el(e.ve_estatus_gen),P(e.ve_observaciones),b(!1)}).catch(e=>{y(e),b(!1)}),fetch("/api/vehiculos/seguro/".concat(s)).then(e=>{if(e.ok)return e.json()}).then(e=>{eh(e),e&&T(e.segu_nombre),e&&D(e.segu_monto_pago),e&&R(ex(e.segu_vigencia))}).catch(e=>{y(e),b(!1)})):i.push("/")},[s,i]);let ex=e=>{let a=new Date(e);a.setHours(a.getHours()+a.getTimezoneOffset()/60);let s=String(a.getDate()).padStart(2,"0"),n=String(a.getMonth()+1).padStart(2,"0"),t=a.getFullYear();return"".concat(t,"-").concat(n,"-").concat(s)};return N?(0,n.jsx)("div",{className:o().loadingScreen,children:(0,n.jsx)(l.Z,{})}):C?(0,n.jsx)("div",{className:o().error,children:(0,n.jsxs)("div",{className:o().errorContent,children:[(0,n.jsx)(g(),{className:o().textIcon,name:"cloud-offline-outline"}),(0,n.jsx)("p",{className:o().textError,children:"No hay Conexi\xf3n"})]})}):(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:o().navegacion,children:(0,n.jsxs)("h4",{children:[(0,n.jsx)(r.default,{href:"/vehiculos",className:o().link,children:"Vehiculos"})," ","\\ Informaci\xf3n"]})}),ep?(0,n.jsxs)("div",{className:o().container,children:[(0,n.jsxs)("div",{className:o().subConteiner1,children:[(0,n.jsxs)("div",{className:o().vehiculo,children:[(0,n.jsx)("img",{className:o().imagen,src:ep.ve_imagen,alt:"imagen del vehiculo"}),(0,n.jsxs)("h3",{className:o().titulo,children:[ep.ve_marca," ",ep.ve_modelo," ",ep.ve_ano]})]}),(0,n.jsx)("div",{className:o().banner,children:(0,n.jsx)("h3",{children:"Observaciones"})}),(0,n.jsxs)("div",{className:o().observaciones,children:[x?(0,n.jsxs)("div",{className:o().observacionesContenido,children:[(0,n.jsx)(d.II,{placeholder:"Editar Observaciones",value:k,onChange:e=>{P(e)},type:"text",validation:E}),(0,n.jsx)(d.zx,{text:"Aceptar",type:"aceptar",onPress:()=>{if(""==k){z(!0);return}z(!1),fetch("/api/vehiculos/".concat(s),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({ve_observaciones:k})}),j(!1),console.log(k)}})]}):(0,n.jsx)("div",{className:o().observacionesContenido,children:(0,n.jsx)("p",{children:k})}),(0,n.jsx)(d.zx,{text:"".concat(x?"Cancelar":"Editar"),type:"aceptar",onPress:()=>{j(!x)}})]}),(0,n.jsx)("div",{className:o().banner,children:(0,n.jsx)("h3",{children:"Seguro"})}),(0,n.jsxs)("div",{className:o().seguro,children:[(0,n.jsx)("div",{className:o().seguroContenido,children:f?(0,n.jsxs)("div",{children:[(0,n.jsx)(d.II,{type:"text",placeholder:"Nombre",value:w,onChange:e=>{T(e)},validation:I}),(0,n.jsx)(d.II,{type:"number",placeholder:"Monto",value:V,onChange:e=>{D(e)},validation:A}),(0,n.jsx)(_.F,{text:"Vigencia: ",value:M,onChange:e=>{R(e)},validation:Z}),(0,n.jsx)(d.zx,{text:"Aceptar",type:"aceptar",onPress:()=>{if(""==w&&O(!0),V<=0&&F(!0),""==M)H(!0);else if(""!=w&&""!=V){O(!1),F(!1),H(!1);let e={ve_id:s,segu_nombre:w,segu_monto_pago:V,segu_vigencia:M};eu?(console.log("?"),fetch("/api/vehiculos/seguro/".concat(s),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).catch(e=>{console.log(e.message)})):(console.log("no existe seguro"),fetch("/api/vehiculos/seguro",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).catch(e=>{console.log(e.message)})),window.location.reload()}}})]}):(0,n.jsx)("div",{children:eu?(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:o().text,children:" Nombre: "}),eu.segu_nombre]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:o().text,children:" Monto: "}),"$",eu.segu_monto_pago]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:o().text,children:" Vigencia: "}),ex(eu.segu_vigencia)]})]}):(0,n.jsx)("div",{className:o().sinSeguro,children:(0,n.jsx)("p",{children:"No hay seguro"})})})}),(0,n.jsx)(d.zx,{text:f?"Cancelar":"Editar",type:"aceptar",onPress:()=>{S(!f)}})]})]}),(0,n.jsxs)("div",{className:o().subConteiner2,children:[(0,n.jsx)("div",{className:o().banner,children:(0,n.jsx)("h3",{children:"Informaci\xf3n"})}),(0,n.jsxs)("div",{className:o().informacion,children:[(0,n.jsxs)("h3",{className:o().titulo,children:[ep.ve_marca," ",ep.ve_modelo," ",ep.ve_ano]}),(0,n.jsxs)("div",{className:o().infoContainer,children:[(0,n.jsxs)("div",{className:o().infoTexto,children:[(0,n.jsxs)("p",{className:o().separacion,children:[(0,n.jsx)("span",{className:o().text,children:"Agencia:"})," ",Y]}),(0,n.jsxs)("p",{className:o().separacion,children:[(0,n.jsx)("span",{className:o().text,children:"Capacidad: "}),G," Kg"]}),(0,n.jsxs)("p",{className:o().separacion,children:[(0,n.jsx)("span",{className:o().text,children:"Propietario: "}),B]}),(0,n.jsxs)("p",{className:o().separacion,children:[(0,n.jsx)("span",{className:o().text,children:"Entidad: "}),ee]}),(0,n.jsxs)("p",{className:o().separacion,children:[(0,n.jsx)("span",{className:o().text,children:"Placa: "}),et]}),(0,n.jsxs)("p",{className:o().separacion,children:[(0,n.jsx)("span",{className:o().text,children:"Estado: "}),er]})]}),(0,n.jsx)("div",{className:o().infoEdicion,children:u&&(0,n.jsxs)("div",{children:[(0,n.jsx)(d.II,{placeholder:"Agencia",type:"text",value:Y,onChange:e=>{J(e)},validation:U}),(0,n.jsx)(d.II,{placeholder:"Capacidad",type:"text",value:G,onChange:e=>{Q(e)},validation:W}),(0,n.jsx)(d.II,{placeholder:"Propietarios",type:"text",value:B,onChange:e=>{X(e)},validation:$}),(0,n.jsx)(d.II,{placeholder:"Entidad",type:"text",value:ee,onChange:e=>{ea(e)},validation:es}),(0,n.jsx)(d.II,{placeholder:"Placa",type:"text",value:et,onChange:e=>{ei(e)},validation:eo}),(0,n.jsx)(m,{data:[{id:1,nombre:"Optimo"},{id:2,nombre:"Revisi\xf3n"},{id:3,nombre:"Fuera de Servicio"}],onSelect:e=>el(e),validar:ed,text:"Estado: ",value:er})]})}),(0,n.jsx)("div",{className:"".concat(o().infoBotones," ").concat(u?o().enEdicion:o().noEdicion),children:u?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:o().empySpace}),(0,n.jsxs)("div",{className:o().botonesEdicion,children:[(0,n.jsx)(d.zx,{text:"Cancelar",type:"aceptar",onPress:()=>{h(!u)}}),(0,n.jsx)(d.zx,{text:"Guardar Cambios",type:"aceptar",onPress:()=>{""==Y&&L(!0),(G<=0||""==G)&&q(!0),""==B&&K(!0),""==ee&&en(!0),""==et?ec(!0):(fetch("/api/vehiculos/".concat(s),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({ve_agencia:Y,ve_capacidad:G,ve_entidad:ee,ve_propietario:B,ve_placas:et,ve_estatus_gen:er})}),h(!u))}})]})]}):(0,n.jsx)(d.zx,{text:"Editar",type:"aceptar",onPress:()=>{h(!u)}})})]})]}),(0,n.jsx)(p,{id:s})]})]}):(0,n.jsx)("div",{className:o().carga,children:(0,n.jsx)(l.Z,{})})]})}},8116:function(e,a,s){"use strict";s.d(a,{Z:function(){return o}});var n=s(7437);s(2265);var t=s(6065),i=s.n(t);function o(){return(0,n.jsxs)("div",{className:i().contenedor,children:[(0,n.jsx)("div",{className:i().cuadrado1}),(0,n.jsx)("div",{className:i().cuadrado2})]})}},4067:function(e,a,s){"use strict";s.d(a,{F:function(){return l},a:function(){return o}});var n=s(7437);s(2265);var t=s(5338),i=s.n(t),o=function(e){let{text:a,timeSelect:s,time:t,validation:o}=e;return(0,n.jsxs)("div",{className:i()["time-picker-container"],children:[(0,n.jsx)("label",{htmlFor:"time",className:"".concat(i()["time-picker-label"]," ").concat(o?i().validation:""),children:a}),(0,n.jsx)("input",{id:"time",type:"time",value:t,onChange:e=>{s(e.target.value)},className:"".concat(i()["time-picker-input"]," ").concat(o?i().validation:""),step:"300"})]})},c=s(480),r=s.n(c),l=function(e){let{text:a,value:s,onChange:t,validation:i}=e;return(0,n.jsxs)("div",{className:"".concat(r().container," ").concat(i?r().validation:""),children:[(0,n.jsx)("label",{children:a}),(0,n.jsx)("input",{className:"".concat(r().date," ").concat(i?r().validation:""),type:"date",value:s,onChange:e=>{t(e.target.value)}})]})}},9144:function(e){e.exports={navegacion:"page_navegacion__x3zEG",link:"page_link__NYfTY",container:"page_container__iIzu0",vehiculo:"page_vehiculo__w1PS3",informacion:"page_informacion__TEYO2",seguro:"page_seguro__c1YEk",seguroContenido:"page_seguroContenido__wtYmj",sinSeguro:"page_sinSeguro__4_DIP",observaciones:"page_observaciones__rov2h",observacionesContenido:"page_observacionesContenido__H10AX",serviciosMenu:"page_serviciosMenu__7BOZC",servicios:"page_servicios__82rNW",subConteiner1:"page_subConteiner1__m6a00",subConteiner2:"page_subConteiner2__x_TAj",imagen:"page_imagen__LasFD",titulo:"page_titulo__P42JE",infoContainer:"page_infoContainer__lfos1",infoTexto:"page_infoTexto__GbzfE",infoEdicion:"page_infoEdicion__gfZdE",noEdicion:"page_noEdicion__kigjk",enEdicion:"page_enEdicion__Qk5LP",infoBotones:"page_infoBotones__WNz5b",separacion:"page_separacion__YHMpd",text:"page_text__Vw6Uq",carga:"page_carga___ELP6",botonesSpace:"page_botonesSpace__27Q40",empySpace:"page_empySpace__JNrcg",botonesEdicion:"page_botonesEdicion__UD_qY",sinServicio:"page_sinServicio__swynj",banner:"page_banner__FsipR",edicionSerguro:"page_edicionSerguro__Z9ZlP",containerVe:"page_containerVe__HztkO",selectVe:"page_selectVe__Hm77D",validarVe:"page_validarVe___tDXe",validarTextoVe:"page_validarTextoVe__4m_dq",loadingScreen:"page_loadingScreen__1RUMC",error:"page_error__dkaSQ",textIcon:"page_textIcon__WcONq",textError:"page_textError__6AZiX",errorContent:"page_errorContent__g5QaE"}},480:function(e){e.exports={container:"DatePick_container__Iz8Yd",date:"DatePick_date__H2cuu",validation:"DatePick_validation__xtQCJ"}},5338:function(e){e.exports={"time-picker-container":"TimePick_time-picker-container__ypGNX","time-picker-label":"TimePick_time-picker-label__UzI3b","time-picker-input":"TimePick_time-picker-input__AxGwA",validation:"TimePick_validation__FDMTC"}},7921:function(e){e.exports={banner:"Servicios_banner__ZNWSD",serviciosMenu:"Servicios_serviciosMenu__bh7bN",servicios:"Servicios_servicios__pVbiC",sinServicio:"Servicios_sinServicio__hwFoZ",espaciado:"Servicios_espaciado__OWzmi"}},6065:function(e){e.exports={cuadrado1:"LoadingScreen_cuadrado1__7A200",cuadrado2:"LoadingScreen_cuadrado2__NNxpH",moverCuadrado1:"LoadingScreen_moverCuadrado1__8i1jV",moverCuadrado2:"LoadingScreen_moverCuadrado2__pz35P"}}},function(e){e.O(0,[3279,1316,7123,8153,6307,7648,4868,2971,2117,1744],function(){return e(e.s=492)}),_N_E=e.O()}]);