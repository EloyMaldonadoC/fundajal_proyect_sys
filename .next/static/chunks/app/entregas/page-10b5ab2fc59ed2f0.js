(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6062],{6805:function(e,a,n){Promise.resolve().then(n.bind(n,849))},849:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return p}});var r=n(7437),s=n(2265),t=n(3527),i=n.n(t),o=n(7648),c=n(9376),d=n(4868),l=n(8116),x=n(1334),u=n.n(x);let h=e=>{if(null==e)return"A\xfan no se ha programado una fecha de entrega";{let a=new Date(e),n=["Domingo","Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado"][a.getUTCDay()],r=a.getUTCDate(),s=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][a.getUTCMonth()],t=a.getUTCFullYear();return"".concat(n," ").concat(r," de ").concat(s," del ").concat(t)}};var m=function(e){let{entrega:a,disabled:n}=e,t=!!n,i=(0,c.useRouter)(),{cliente:o,empleados:d,vehiculos:l,encargado:x}=a,[m,g]=(0,s.useState)(!1),[_,j]=(0,s.useState)(""),p=h(a.entrega.en_dia_entrega),v=()=>{switch(!0){case"en edici\xf3n"===a.entrega.en_estado:case"por confirmar"===a.entrega.en_estado:i.push("/entregas/entrega?id=".concat(a.entrega.en_id));break;case"preparaci\xf3n"===a.entrega.en_estado:i.push("/entregas/preparacion?id=".concat(a.entrega.en_id));break;case"recibir"===a.entrega.en_estado:i.push("/entregas/recibir?id=".concat(a.entrega.en_id));break;case"recibido"===a.entrega.en_estado:i.push("/entregas/recibido?id=".concat(a.entrega.en_id));break;case"finalizada"===a.entrega.en_estado:i.push("/entregas/finalizada?id=".concat(a.entrega.en_id))}};return m?(0,r.jsxs)("div",{className:u().contenedor,children:[(0,r.jsxs)("div",{className:u().municipio,children:[(0,r.jsx)("div",{className:u().skeletonText}),(0,r.jsx)("div",{className:u().skeletonText}),(0,r.jsx)("div",{className:u().skeletonText})]}),(0,r.jsxs)("div",{className:u().encargado,children:[(0,r.jsx)("div",{className:u().skeletonText}),(0,r.jsx)("div",{className:u().skeletonText})]}),(0,r.jsxs)("div",{className:u().vehiculos,children:[(0,r.jsx)("div",{className:u().skeletonText}),(0,r.jsx)("div",{className:u().skeletonText}),(0,r.jsx)("div",{className:u().skeletonText})]}),(0,r.jsx)("div",{className:u().skeletonText})]}):_?(0,r.jsxs)("p",{children:["Error: ",_.message]}):(0,r.jsxs)("div",{className:u().contenedor,onClick:()=>{t&&v()},children:[(0,r.jsxs)("div",{className:u().municipio,children:[(0,r.jsxs)("h3",{className:u().espacioTitulo,children:[o.cli_municipio,", ",o.cli_estado,"."]}),(0,r.jsxs)("p",{className:u().espacio,children:[(0,r.jsx)("span",{className:u().texto,children:"D\xeda de la Entrega: "}),p]})]}),(0,r.jsxs)("div",{className:u().encargado,children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:u().texto,children:"Encargado: "}),x.emp_nombre," ",x.emp_apellido]}),0!=d.length&&(0,r.jsx)("div",{children:d.map((e,a)=>(0,r.jsxs)("p",{children:[(0,r.jsxs)("b",{children:["(",e.emp_rol,")"]})," ",e.emp_nombre," ",e.emp_apellido]},a))})]}),0!=l.length&&(0,r.jsxs)("div",{className:u().vehiculos,children:[(0,r.jsx)("h4",{children:"Vehiculo/s"}),l.map((e,a)=>(0,r.jsx)("div",{children:(0,r.jsxs)("p",{children:[e.ve_marca," ",e.ve_modelo]})},a))]}),(0,r.jsxs)("div",{className:u().estado,children:[(0,r.jsx)("div",{className:"".concat((a.entrega.en_estado,u().edicion)," ").concat("finalizada"==a.entrega.en_estado&&u().finalizado," ").concat("cancelada"==a.entrega.en_estado&&u().cancelado)}),a.entrega.en_estado]})]})},g=n(8999),_=n.n(g),j=n(605);function p(){let{data:e,status:a}=(0,j.useSession)(),n=(0,c.useRouter)(),[t,x]=(0,s.useState)([]),[u,h]=(0,s.useState)(!0),[g,p]=(0,s.useState)(""),[v,N]=(0,s.useState)(""),[C,f]=(0,s.useState)(""),[E,b]=(0,s.useState)(null),[w,S]=(0,s.useState)(0),[L,k]=(0,s.useState)([]),[T,z]=(0,s.useState)(10),[A,F]=(0,s.useState)([]),[y,P]=(0,s.useState)([]),[D,I]=(0,s.useState)([]),[H,M]=(0,s.useState)([]),[q,J]=(0,s.useState)([]),[U,V]=(0,s.useState)([]),[Z,O]=(0,s.useState)(!0),[R,X]=(0,s.useState)(!1),[Y,K]=(0,s.useState)(!1),[Q,W]=(0,s.useState)(!1),[B,G]=(0,s.useState)(!1),[$,ee]=(0,s.useState)(!1),[ea,en]=(0,s.useState)(!1);(0,s.useEffect)(()=>{console.log("se renderiza"),"Administrador"===e.user.role||"Encargado"===e.user.role?fetch("/api/entregas/cardEntregas?page=".concat(w+1,"&limit=").concat(T).concat(E?"&filter=".concat(E):"").concat("Encargado"===e.user.role?"&user=".concat(e.user.id):"")).then(e=>{if(!e.ok)throw Error("Response is not ok");return e.json()}).then(e=>{h(!1),x([...t,...e])}).catch(e=>{p(e),h(!1)}):n.push("/")},[w,E]),(0,s.useEffect)(()=>{t&&(k(t),F(t.filter(e=>null===e.entrega.en_dia_entrega)),P(t.filter(e=>"en edici\xf3n"==e.entrega.en_estado)),I(t.filter(e=>"preparaci\xf3n"===e.entrega.en_estado)),J(t.filter(e=>"finalizada"===e.entrega.en_estado)),V(t.filter(e=>"cancelada"===e.entrega.en_estado)),M(t.filter(e=>"recibir"===e.entrega.en_estado||"recibido"===e.entrega.en_estado)))},[t,E]),(0,s.useEffect)(()=>{let e=()=>{let e=window.scrollY||document.documentElement.scrollTop,a=document.documentElement.scrollHeight;e+(window.innerHeight||document.documentElement.clientHeight)>=a-5&&er()&&S(w+1)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[L]);let er=()=>!(t.length-w*T<10),es=()=>{O(!0),X(!1),K(!1),W(!1),ee(!1),G(!1),en(!1)},et=()=>{O(!1),X(!0),K(!1),W(!1),ee(!1),G(!1),en(!1)},ei=()=>{O(!1),X(!1),K(!0),W(!1),ee(!1),G(!1),en(!1)},eo=()=>{O(!1),X(!1),K(!1),W(!0),ee(!1),G(!1),en(!1)},ec=()=>{O(!1),X(!1),K(!1),W(!1),ee(!0),G(!1),en(!1)},ed=()=>{O(!1),X(!1),K(!1),W(!1),ee(!1),en(!1),G(!0)};return u?(0,r.jsx)("div",{className:i().loadingScreen,children:(0,r.jsx)(l.Z,{})}):g?(0,r.jsx)("div",{className:i().error,children:(0,r.jsxs)("div",{className:i().errorContent,children:[(0,r.jsx)(_(),{className:i().textIcon,name:"cloud-offline-outline"}),(0,r.jsx)("p",{className:i().textError,children:"No hay Conexi\xf3n"})]})}):(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:i().navegacion,children:(0,r.jsxs)("h4",{children:[(0,r.jsx)(o.default,{href:"/entregas",className:i().link,children:"Entregas"})," ","\\"," "]})}),(0,r.jsxs)("div",{className:i().herramientas,children:[(0,r.jsxs)("div",{className:i().busqueda,children:[(0,r.jsx)(d.ol,{placeholder:"Filtrar por municipio",onSearch:e=>N(e)}),(0,r.jsx)(d.ol,{placeholder:"Filtrar por encargado",onSearch:e=>f(e)})]}),(0,r.jsxs)("div",{className:i().filtro,children:[(0,r.jsxs)("div",{className:i().ajustarfiltro,children:[(0,r.jsx)(d.zx,{text:"Todos",type:Z?"cancelar":"",onPress:()=>{S(0),b(null),x([]),es()}}),(0,r.jsx)(d.zx,{text:"Pendientes",type:R?"cancelar":"",onPress:()=>{S(0),x([]),b("por%20confirmar"),et()}}),(0,r.jsx)(d.zx,{text:"En Edici\xf3n",type:Y?"cancelar":"",onPress:()=>{S(0),x([]),b("en%20edici\xf3n"),ei()}}),"Administrador"===e.user.role&&(0,r.jsx)(d.zx,{text:"Preparaci\xf3n",type:Q?"cancelar":"",onPress:()=>{S(0),x([]),b("preparaci\xf3n"),eo()}}),(0,r.jsx)(d.zx,{text:"En Proceso",type:B?"cancelar":"",onPress:()=>{S(0),x([]),b("%reci%"),ed()}}),(0,r.jsx)(d.zx,{text:"Finalizados",type:$?"cancelar":"",onPress:()=>{S(0),x([]),b("finalizada"),ec()}})]}),(0,r.jsx)(d.zx,{text:"Nueva Entrega",type:"cancelar",onPress:()=>{n.push("/entregas/nuevo")}})]})]}),(0,r.jsxs)("div",{className:i().contenido,children:[Z&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:i().banner,children:(0,r.jsx)("h3",{children:"Todas las Entregas"})}),0!=L.length?(0,r.jsx)(r.Fragment,{children:L.filter(e=>e.cliente.cli_municipio.toLowerCase().includes(v.toLowerCase())&&e.encargado.emp_nombre.toLowerCase().includes(C.toLowerCase())).map((a,n)=>(0,r.jsx)("div",{children:(0,r.jsx)(m,{entrega:a,disabled:"Administrador"===e.user.role||("Encargado"!==e.user.role||"preparaci\xf3n"==a.entrega.en_estado)&&!1})},n))}):(0,r.jsx)("div",{className:i().errorContent,children:(0,r.jsx)("h1",{className:i().textError,children:"A\xfan no hay entregas"})})]}),R&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:i().banner,children:(0,r.jsx)("h3",{children:"Pendientes"})}),0!=A.length?(0,r.jsx)(r.Fragment,{children:A.filter(e=>e.cliente.cli_municipio.toLowerCase().includes(v.toLowerCase())&&e.encargado.emp_nombre.toLowerCase().includes(C.toLowerCase())).map((a,n)=>(0,r.jsx)("div",{children:(0,r.jsx)(m,{entrega:a,disabled:"Administrador"===e.user.role||"Encargado"===e.user.role})},n))}):(0,r.jsx)("div",{className:i().errorContent,children:(0,r.jsx)("h1",{className:i().textError,children:"A\xfan no hay entregas"})})]}),Y&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:i().banner,children:(0,r.jsx)("h3",{children:"En Edici\xf3n"})}),0!=y.length?(0,r.jsx)(r.Fragment,{children:y.filter(e=>e.cliente.cli_municipio.toLowerCase().includes(v.toLowerCase())&&e.encargado.emp_nombre.toLowerCase().includes(C.toLowerCase())).map((a,n)=>(0,r.jsx)("div",{children:(0,r.jsx)(m,{entrega:a,disabled:"Administrador"===e.user.role||"Encargado"===e.user.role})},n))}):(0,r.jsx)("div",{className:i().errorContent,children:(0,r.jsx)("h1",{className:i().textError,children:"A\xfan no hay entregas"})})]}),Q&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:i().banner,children:(0,r.jsx)("h3",{children:"Preparaci\xf3n"})}),0!=D.length?(0,r.jsx)(r.Fragment,{children:D.filter(e=>e.cliente.cli_municipio.toLowerCase().includes(v.toLowerCase())&&e.encargado.emp_nombre.toLowerCase().includes(C.toLowerCase())).map((a,n)=>(0,r.jsx)("div",{children:(0,r.jsx)(m,{entrega:a,disabled:"Administrador"===e.user.role})},n))}):(0,r.jsx)("div",{className:i().errorContent,children:(0,r.jsx)("h1",{className:i().textError,children:"A\xfan no hay entregas"})})]}),B&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:i().banner,children:(0,r.jsx)("h3",{children:"En Proceso"})}),0!=H.length?(0,r.jsx)("div",{children:H.filter(e=>e.cliente.cli_municipio.toLowerCase().includes(v.toLowerCase())&&e.encargado.emp_nombre.toLowerCase().includes(C.toLowerCase())).map((a,n)=>(0,r.jsx)("div",{children:(0,r.jsx)(m,{entrega:a,disabled:"Administrador"===e.user.role})},n))}):(0,r.jsx)("div",{className:i().errorContent,children:(0,r.jsx)("h1",{className:i().textError,children:"A\xfan no hay entregas"})})]}),$&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:i().banner,children:(0,r.jsx)("h3",{children:"Finalizadas"})}),0!=q.length?(0,r.jsx)(r.Fragment,{children:q.filter(e=>e.cliente.cli_municipio.toLowerCase().includes(v.toLowerCase())&&e.encargado.emp_nombre.toLowerCase().includes(C.toLowerCase())).map((a,n)=>(0,r.jsx)("div",{children:(0,r.jsx)(m,{entrega:a,disabled:"Administrador"===e.user.role||"Encargado"===e.user.role})},n))}):(0,r.jsx)("div",{className:i().errorContent,children:(0,r.jsx)("h1",{className:i().textError,children:"A\xfan no hay entregas"})})]}),ea&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:i().banner,children:(0,r.jsx)("h3",{children:"Canceladas"})}),0!=U.length?(0,r.jsx)(r.Fragment,{children:U.filter(e=>e.cliente.cli_municipio.toLowerCase().includes(v.toLowerCase())&&e.encargado.emp_nombre.toLowerCase().includes(C.toLowerCase())).map((e,a)=>(0,r.jsx)("div",{children:(0,r.jsx)(m,{entrega:e})},a))}):(0,r.jsx)("div",{children:"no hay entregas canceladas"})]})]})]})}},8116:function(e,a,n){"use strict";n.d(a,{Z:function(){return i}});var r=n(7437);n(2265);var s=n(6065),t=n.n(s);function i(){return(0,r.jsxs)("div",{className:t().contenedor,children:[(0,r.jsx)("div",{className:t().cuadrado1}),(0,r.jsx)("div",{className:t().cuadrado2})]})}},3527:function(e){e.exports={navegacion:"page_navegacion__nCmq_",link:"page_link__N28Dx",contenido:"page_contenido__IlZh0",herramientas:"page_herramientas__nVAIJ",busqueda:"page_busqueda__irD2f",filtro:"page_filtro__LtSQe",ajustarfiltro:"page_ajustarfiltro__S9xZY",banner:"page_banner__r2109",loadingScreen:"page_loadingScreen__woifV",error:"page_error__MHHZ6",textIcon:"page_textIcon__1XqSl",textError:"page_textError__vt_K2",errorContent:"page_errorContent__22iBX"}},1334:function(e){e.exports={contenedor:"CardEntrega_contenedor__jkkID",municipio:"CardEntrega_municipio__i4KvW",encargado:"CardEntrega_encargado__EaSkz",vehiculos:"CardEntrega_vehiculos__SiWF2",estado:"CardEntrega_estado__NjirO",edicion:"CardEntrega_edicion__Ii6xp",finalizado:"CardEntrega_finalizado__yegAA",cancelado:"CardEntrega_cancelado__xUj0x",texto:"CardEntrega_texto__eX2ck",espacioTitulo:"CardEntrega_espacioTitulo___jQD0",espacio:"CardEntrega_espacio__h91TR",skeletonText:"CardEntrega_skeletonText__6_D9G",loading:"CardEntrega_loading__JiLst"}},6065:function(e){e.exports={cuadrado1:"LoadingScreen_cuadrado1__7A200",cuadrado2:"LoadingScreen_cuadrado2__NNxpH",moverCuadrado1:"LoadingScreen_moverCuadrado1__8i1jV",moverCuadrado2:"LoadingScreen_moverCuadrado2__pz35P"}}},function(e){e.O(0,[614,7123,1316,8153,6307,7648,4868,2971,2117,1744],function(){return e(e.s=6805)}),_N_E=e.O()}]);