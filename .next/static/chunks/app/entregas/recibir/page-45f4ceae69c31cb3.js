(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8191],{3720:function(e,a,n){Promise.resolve().then(n.bind(n,6347))},6347:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return T}});var r=n(7437),o=n(2265),s=n(1187),t=n.n(s),c=n(9376),i=n(7648),d=n(8116),_=n(8999),l=n.n(_),u=n(4868),p=n(6812),h=n(5171),m=n(7408),x=n(418),j=n.n(x),g=function(e){let{value:a,onSelect:n,onUnselect:s,estado:t}=e,[c,i]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{t&&"recibido"==t?i(!0):i(!1)},[t]),(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"checkbox",className:j().checkbox,value:a,checked:c,onChange:e=>{let a=e.target.value;c?s(a):n(a),i(!c)}})})},b=n(731),v=n.n(b),N=function(e){let{listaProductos:a,salida:n}=e,o=e=>{n(a.map(a=>a.produc_id==e?{...a,en_es_produc_estado:"recibido"}:a))},s=e=>{n(a.map(a=>a.produc_id==e?{...a,en_es_produc_estado:"cargado"}:a))};return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:v().header,children:(0,r.jsx)("h3",{children:"Productos a entregar"})}),(0,r.jsxs)("div",{className:v().titulo,children:[(0,r.jsx)("h4",{className:v().nombre,children:"Producto"}),(0,r.jsx)("h4",{className:v().cantidad,children:"cantidad"}),(0,r.jsx)("h4",{className:v().checkBox,children:"Listo"})]}),a&&a.map((e,a)=>(0,r.jsxs)("div",{className:v().container,children:[(0,r.jsx)("div",{className:v().nombre,children:e.produc_nombre}),(0,r.jsx)("div",{className:v().cantidad,children:e.en_es_produc_cant}),(0,r.jsx)("div",{className:v().checkBox,children:(0,r.jsx)(g,{estado:e.en_es_produc_estado,value:e.produc_id,onSelect:e=>{o(e)},onUnselect:e=>{s(e)}})})]},a)),(0,r.jsx)("div",{className:v().fooder})]})},f=n(3730),E=n(605),C=n(9172);let S=e=>{if(null==e)return"A\xfan no se ha programado una fecha de entrega";{let a=new Date(e),n=["Domingo","Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado"][a.getUTCDay()],r=a.getUTCDate(),o=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][a.getUTCMonth()],s=a.getUTCFullYear();return"".concat(n," ").concat(r," de ").concat(o," del ").concat(s)}},k=e=>{if(null==e)return"Hora no especificada";{let[a,n]=e.split(":");return"".concat(a,":").concat(n)}};var T=function(){let e=(0,c.useSearchParams)(),a=(0,c.useRouter)(),n=e.get("id"),{data:s}=(0,E.useSession)(),[_,x]=(0,o.useState)(!0),[j,g]=(0,o.useState)(""),[b,v]=(0,o.useState)(!1),[T,w]=(0,o.useState)(!1),[y,D]=(0,o.useState)(!1),[P,R]=(0,o.useState)(!0),[V,Z]=(0,o.useState)(!1),[z,L]=(0,o.useState)(0),[I,A]=(0,o.useState)(0),[M,O]=(0,o.useState)(""),[U,G]=(0,o.useState)(0),[F,B]=(0,o.useState)([]),[J,Q]=(0,o.useState)([]),[X,K]=(0,o.useState)([]),[q,Y]=(0,o.useState)([]),[H,W]=(0,o.useState)([]),[$,ee]=(0,o.useState)([]),[ea,en]=(0,o.useState)([]);(0,o.useEffect)(()=>{"Administrador"===s.user.role||"Encargado"===s.user.role?(fetch("/api/entregas/".concat(n)).then(e=>{if(!e.ok)throw Error("Response is not ok");return e.json()}).then(e=>{"recibir"!=e.en_estado?a.push("/entregas"):(B(e),x(!1))}).catch(e=>{g(e)}),fetch("/api/entregas/empleados/".concat(n)).then(e=>{if(!e.ok)throw Error("response is not ok");return e.json()}).then(e=>{Q(e)}).catch(e=>{g(e),x(!1)}),fetch("/api/entregas/vehiculos/".concat(n)).then(e=>{if(!e.ok)throw Error("Response is not ok");return e.json()}).then(e=>{K(e)}).catch(e=>{g(e),x(!1)}),fetch("/api/entregas/productos/status/".concat(n)).then(e=>{if(!e.ok)throw Error("Response is  not ok");return e.json()}).then(e=>{if(0!=e.length){let a=e.filter(e=>"cargado"==e.en_es_produc_estado||"recibido"==e.en_es_produc_estado),n=e.filter(e=>"da\xf1ado"==e.en_es_produc_estado),r=e.filter(e=>"extraviado"==e.en_es_produc_estado),o=e.filter(e=>"no encontrado"==e.en_es_produc_estado);Y(a),ee(n),W(r),en(o)}}).catch(e=>{g(e),x(!1)})):a.push("/")},[n,a]);let er=()=>{if(0!=I&&""!=M&&0!=U){let e={...q.find(e=>e.produc_id==I),en_es_produc_cant:Number(U),en_es_produc_estado:M};if("da\xf1ado"==M){let a=$.find(e=>e.produc_id==I);console.log(a),a?(ee($.map(e=>e.produc_id==I?{...e,en_es_produc_cant:Number(U),en_es_produc_estado:M}:e)),Y(q.map(e=>e.produc_id==I?{...e,en_es_produc_cant:Number(e.en_es_produc_cant)+Number(a.en_es_produc_cant)-Number(U)}:e))):(Y(q.map(e=>e.produc_id==I?{...e,en_es_produc_cant:Number(e.en_es_produc_cant)-Number(U)}:e)),ee([...$,e]))}else if("extraviado"==M){let a=H.find(e=>e.produc_id==I);a?(W(H.map(e=>e.produc_id==I?{...e,en_es_produc_cant:Number(U),en_es_produc_estado:M}:e)),Y(q.map(e=>e.produc_id==I?{...e,en_es_produc_cant:Number(e.en_es_produc_cant)+Number(a.en_es_produc_cant)-Number(U)}:e))):(Y(q.map(e=>e.produc_id==I?{...e,en_es_produc_cant:Number(e.en_es_produc_cant)-Number(U)}:e)),W([...H,e]))}else if("no encontrado"==M){let a=ea.find(e=>e.produc_id==I);a?(en(ea.map(e=>e.produc_id==I?{...e,en_es_produc_cant:Number(U),en_es_produc_estado:M}:e)),Y(q.map(e=>e.produc_id==I?{...e,en_es_produc_cant:Number(e.en_es_produc_cant)+Number(a.en_es_produc_cant)-Number(U)}:e))):(Y(q.map(e=>e.produc_id==I?{...e,en_es_produc_cant:Number(e.en_es_produc_cant)-Number(U)}:e)),en([...ea,e]))}G(0),O(0),A(0)}},eo=e=>{let a=q.find(a=>a.produc_id==e);A(e),L(a.en_es_produc_cant)},es=e=>{let a=H.find(a=>a.produc_id==e);W(H.filter(a=>a.produc_id!=e)),Y(q.map(n=>n.produc_id==e?{...n,en_es_produc_cant:Number(n.en_es_produc_cant)+Number(a.en_es_produc_cant)}:n))},et=e=>{let a=$.find(a=>a.produc_id==e);ee($.filter(a=>a.produc_id!=e)),Y(q.map(n=>n.produc_id==e?{...n,en_es_produc_cant:Number(n.en_es_produc_cant)+Number(a.en_es_produc_cant)}:n))},ec=e=>{let a=ea.find(a=>a.produc_id==e);en(ea.filter(a=>a.produc_id!=e)),Y(q.map(n=>n.produc_id==e?{...n,en_es_produc_cant:Number(n.en_es_produc_cant)+Number(a.en_es_produc_cant)}:n))},ei=async()=>{if(!P){D(!0);try{let e=[...q,...$,...H,...ea];if(console.log(e),!(await fetch("/api/entregas/productos/status/".concat(n),{method:"DELETE"})).ok||!(await fetch("/api/entregas/productos/status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Response is not ok");R(!0)}catch(e){g(e)}D(!1)}},ed=()=>{q.some(e=>"cargado"==e.en_es_produc_estado)?w(!0):v(!0)},e_=async()=>{if(P){try{await fetch("/api/entregas/".concat(n),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({en_estado:"recibido"})}).then(e=>{if(!e.ok)throw Error("Response is not ok");return e.json()}).catch(e=>{g(e)})}catch(e){g(e)}a.push("/entregas/recibido?id=".concat(n))}};return _?(0,r.jsx)("div",{className:t().loadingScreen,children:(0,r.jsx)(d.Z,{})}):j?(0,r.jsx)("div",{className:t().error,children:(0,r.jsxs)("div",{className:t().errorContent,children:[(0,r.jsx)(l(),{className:t().textIcon,name:"cloud-offline-outline"}),(0,r.jsx)("p",{className:t().textError,children:"No hay Conexi\xf3n"})]})}):(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:t().navegacion,children:(0,r.jsxs)("h4",{children:[(0,r.jsx)(i.default,{href:"/entregas",className:t().link,children:"Entregas"})," ","\\ Recibir \\"," ",0!=F.length?"".concat(F.cli_municipio,", ").concat(F.cli_estado,"."):"Cargando..."]})}),(0,r.jsxs)("div",{className:t().herramientas,children:[0!=F.length&&(0,r.jsxs)("p",{children:["Entrega programada para el d\xeda"," ",(0,r.jsx)("b",{children:S(F.en_dia_entrega)})," a las"," ",(0,r.jsxs)("b",{children:[k(F.en_hora_entrega)," hrs"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(u.zx,{text:"Terminado",onPress:()=>{ed(),ei()}}),(0,r.jsx)(u.zx,{text:P?"Guardado":"Guardar",type:"cancelar",onPress:()=>ei()})]})]}),(0,r.jsxs)("div",{className:t().contenido,children:[(0,r.jsxs)("div",{className:t().subContenedor1,children:[(0,r.jsxs)("div",{className:t().cambiarEstado,children:[(0,r.jsxs)("select",{className:t().select,onChange:e=>{eo(e.target.value)},value:I,children:[(0,r.jsx)("option",{value:0,children:"-Seleccionar producto-"}),q.map((e,a)=>(0,r.jsx)("option",{value:e.produc_id,children:e.produc_nombre},a))]}),(0,r.jsxs)("select",{className:t().select,onChange:e=>O(e.target.value),value:M,children:[(0,r.jsx)("option",{className:t().option,value:0,children:"-Seleccionar estado-"}),(0,r.jsx)("option",{className:t().option,value:"extraviado",children:"Extraviado"}),(0,r.jsx)("option",{className:t().option,value:"da\xf1ado",children:"Da\xf1ado"}),(0,r.jsx)("option",{className:t().option,value:"no encontrado",children:"No encontrado"})]}),(0,r.jsxs)("div",{className:t().inputNumberContainer,children:[(0,r.jsx)("label",{children:"Cantidad: "}),(0,r.jsx)("input",{className:t().inputNumber,type:"number",min:0,max:z,value:U,onChange:e=>G(e.target.value)})]}),(0,r.jsx)(u.zx,{text:"Aceptar",type:"cancelar",onPress:()=>{er(),R(!1)}})]}),(0,r.jsx)(N,{listaProductos:q,salida:e=>{Y(e),R(!1)}}),0!=H.length&&(0,r.jsx)(f.Z,{titulo:"Productos Extraviados",listaProductos:H,onDelete:e=>{es(e),R(!1)}}),0!=ea.length&&(0,r.jsx)(f.Z,{titulo:"Productos No encontrados",listaProductos:ea,onDelete:e=>{ec(e),R(!1)}}),0!=$.length&&(0,r.jsx)(f.Z,{titulo:"Productos Da\xf1ados",listaProductos:$,onDelete:e=>{et(e),R(!1)}})]}),(0,r.jsxs)("div",{className:t().subContenedor2,children:[(0,r.jsx)("div",{className:t().herramientasInfo,children:(0,r.jsx)(u.zx,{text:V?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"Visualizar"}),(0,r.jsx)(l(),{className:t().icon,name:"eye-outline"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"Ocultar"}),(0,r.jsx)(l(),{className:t().icon,name:"eye-off-outline"})]}),type:V?"contenido-light":"contenido-dark",onPress:()=>Z(!V)})}),!V&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{municipio:F}),(0,r.jsx)(h.Z,{encargado:F,empleados:J}),(0,r.jsx)(m.Z,{vehiculos:X})]})]})]}),(0,r.jsx)(u.u_,{show:b,title:"Productos recibidos",message:"\xbfTodos los productos han sido recibidos?",handleClose:()=>v(!1),handleAccept:()=>{e_(),D(!0)}}),(0,r.jsx)(u.bZ,{show:T,title:"Falta verificaci\xf3n",message:"No se han verificato todos los productos",handleAccept:()=>w(!1)}),(0,r.jsx)(C.Z,{show:y})]})}},9172:function(e,a,n){"use strict";var r=n(7437),o=n(6660),s=n.n(o);a.Z=function(e){let{show:a}=e;return(0,r.jsx)("div",{className:"".concat(s().modal," ").concat(a?s().show:""),children:(0,r.jsxs)("div",{className:s().contenedor,children:[(0,r.jsx)("div",{className:s().cuadrado1}),(0,r.jsx)("div",{className:s().cuadrado2})]})})}},8116:function(e,a,n){"use strict";n.d(a,{Z:function(){return t}});var r=n(7437);n(2265);var o=n(6065),s=n.n(o);function t(){return(0,r.jsxs)("div",{className:s().contenedor,children:[(0,r.jsx)("div",{className:s().cuadrado1}),(0,r.jsx)("div",{className:s().cuadrado2})]})}},6812:function(e,a,n){"use strict";var r=n(7437),o=n(5550),s=n.n(o);a.Z=function(e){let{municipio:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:s().header,children:(0,r.jsx)("h3",{children:"Municipio"})}),(0,r.jsx)("div",{className:s().container,children:a?(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{children:"Municipio: "}),a.cli_municipio,", ",a.cli_estado]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{children:"Enlace: "}),a.cli_nombre]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{children:"Contacto: "}),a.cli_numero_contac]})]}):(0,r.jsx)("div",{children:(0,r.jsx)("p",{children:"Cargando..."})})}),(0,r.jsx)("div",{className:s().fooder})]})}},3730:function(e,a,n){"use strict";var r=n(7437),o=n(4868),s=n(352),t=n.n(s);a.Z=function(e){let{titulo:a,listaProductos:n,onDelete:s,alterButton:c}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:t().header,children:(0,r.jsx)("h3",{children:a})}),(0,r.jsxs)("div",{className:t().titulo,children:[(0,r.jsx)("h4",{className:t().nombre,children:"Nombre"}),(0,r.jsx)("h4",{className:t().cantidad,children:"cantidad"}),(0,r.jsx)("h4",{className:t().option,children:c&&"opciones"})]}),n&&n.map((e,a)=>(0,r.jsxs)("div",{className:t().container,children:[(0,r.jsx)("div",{className:t().nombre,children:e.produc_nombre}),(0,r.jsx)("div",{className:t().cantidad,children:e.en_es_produc_cant}),(0,r.jsx)("div",{className:t().option,children:c&&(0,r.jsx)(o.zx,{text:c||"Eliminar",type:"cancelar",onPress:()=>s(e.produc_id)})})]},a)),(0,r.jsx)("div",{className:t().fooder})]})}},5171:function(e,a,n){"use strict";var r=n(7437),o=n(7597),s=n.n(o);a.Z=function(e){let{encargado:a,empleados:n}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:s().header,children:(0,r.jsx)("h3",{children:"Personal"})}),(0,r.jsxs)("div",{className:s().container,children:[(0,r.jsxs)("p",{className:s().nombre,children:[(0,r.jsx)("b",{children:"Encargado: "}),a.emp_nombre," ",a.emp_apellido]}),n&&(0,r.jsx)(r.Fragment,{children:n.map((e,a)=>(0,r.jsxs)("p",{className:s().nombre,children:[(0,r.jsxs)("b",{children:[e.emp_rol,": "]}),e.emp_nombre," ",e.emp_apellido]},a))})]}),(0,r.jsx)("div",{className:s().fooder})]})}},7408:function(e,a,n){"use strict";var r=n(7437),o=n(3765),s=n.n(o);a.Z=function(e){let{vehiculos:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:s().header,children:(0,r.jsx)("h3",{children:"Vehiculos"})}),(0,r.jsx)("div",{className:s().container,children:0!=a.length?(0,r.jsx)(r.Fragment,{children:a.map((e,a)=>(0,r.jsxs)("p",{children:[e.ve_marca," ",e.ve_modelo," ",e.ve_ano]},a))}):(0,r.jsx)("p",{children:"A\xfan no se han asignado vehiculos"})}),(0,r.jsx)("div",{className:s().fooder})]})}},1187:function(e){e.exports={navegacion:"page_navegacion__tVAPM",link:"page_link__u3_JC",herramientas:"page_herramientas__vYuYK",contenido:"page_contenido__drjtT",herramientasInfo:"page_herramientasInfo__ij7Ju",icon:"page_icon__z6Ztn",cambiarEstado:"page_cambiarEstado__4_eUv",select:"page_select__OGma8",option:"page_option__uyA7r",inputNumberContainer:"page_inputNumberContainer__Ewirc",inputNumber:"page_inputNumber__KulOD",subContenedor1:"page_subContenedor1__KgXiB",subContenedor2:"page_subContenedor2__Z2VLu",loadingScreen:"page_loadingScreen__Em6NC",error:"page_error__gLioU",textIcon:"page_textIcon__Dag_x",textError:"page_textError__lvZt4",errorContent:"page_errorContent__heUv4"}},418:function(e){e.exports={checkbox:"CheckBoxRecibir_checkbox__7E6i_"}},5550:function(e){e.exports={header:"InfoMunicipio_header__OrBp7",container:"InfoMunicipio_container__8_QG7",fooder:"InfoMunicipio_fooder__wbG4y"}},352:function(e){e.exports={header:"TablaEstadosEntrega_header__4Q2K3",container:"TablaEstadosEntrega_container__EEXBW",fooder:"TablaEstadosEntrega_fooder__o2nGh",titulo:"TablaEstadosEntrega_titulo__5OXhe",texto:"TablaEstadosEntrega_texto__y_P76",nombre:"TablaEstadosEntrega_nombre__9DUle",cantidad:"TablaEstadosEntrega_cantidad__aQLgF",option:"TablaEstadosEntrega_option__N6reG"}},731:function(e){e.exports={header:"TablaRecibirEntrega_header___Zswg",container:"TablaRecibirEntrega_container__CsA7R",fooder:"TablaRecibirEntrega_fooder__5XRke",titulo:"TablaRecibirEntrega_titulo__SIjGl",texto:"TablaRecibirEntrega_texto__N2TDe",nombre:"TablaRecibirEntrega_nombre__U1pXN",cantidad:"TablaRecibirEntrega_cantidad__IlqtI",checkBox:"TablaRecibirEntrega_checkBox__3rDdL"}},7597:function(e){e.exports={header:"VisualizarEmpleadosEntrega_header___vimn",container:"VisualizarEmpleadosEntrega_container__2oQwr",fooder:"VisualizarEmpleadosEntrega_fooder__i3vSU",nombre:"VisualizarEmpleadosEntrega_nombre__l0wgl",wrapper:"VisualizarEmpleadosEntrega_wrapper__MBv5l"}},3765:function(e){e.exports={header:"VisualizarVehiculosEntrega_header__JGbGD",container:"VisualizarVehiculosEntrega_container__SFIJK",fooder:"VisualizarVehiculosEntrega_fooder____Ipl",texto:"VisualizarVehiculosEntrega_texto__7i9x_"}},6660:function(e){e.exports={cuadrado1:"LoadingData_cuadrado1__x1QGj",cuadrado2:"LoadingData_cuadrado2__hOwqp",moverCuadrado1:"LoadingData_moverCuadrado1__vWwXS",moverCuadrado2:"LoadingData_moverCuadrado2__gm3Qs",modal:"LoadingData_modal__Rqj2p",show:"LoadingData_show__jLq8l"}},6065:function(e){e.exports={cuadrado1:"LoadingScreen_cuadrado1__7A200",cuadrado2:"LoadingScreen_cuadrado2__NNxpH",moverCuadrado1:"LoadingScreen_moverCuadrado1__8i1jV",moverCuadrado2:"LoadingScreen_moverCuadrado2__pz35P"}}},function(e){e.O(0,[2495,1316,7123,8153,6307,7648,4868,2971,2117,1744],function(){return e(e.s=3720)}),_N_E=e.O()}]);