(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3109],{910:function(e,o,a){Promise.resolve().then(a.bind(a,9748))},9748:function(e,o,a){"use strict";a.r(o);var r=a(7437),t=a(2265),n=a(7648),i=a(91),s=a.n(i);a(8116);var c=a(4868),d=a(605),l=a(9376),u=a(6806);let p=()=>Math.floor(1e6+9e7*Math.random());o.default=function(){let{data:e,status:o}=(0,d.useSession)(),a=(0,l.useRouter)(),[i,v]=(0,t.useState)(null),[h,_]=(0,t.useState)(""),[x,m]=(0,t.useState)(!0),[g,j]=(0,t.useState)(!1),[S,f]=(0,t.useState)(!1),[P,N]=(0,t.useState)(!1),[y,b]=(0,t.useState)(!1),[C,w]=(0,t.useState)(!1),[I,k]=(0,t.useState)(!1),[O,E]=(0,t.useState)(!1),[T,A]=(0,t.useState)(!1),[z,V]=(0,t.useState)(!1),[D,L]=(0,t.useState)(!1),[M,B]=(0,t.useState)([]),[F,J]=(0,t.useState)([]),[R,K]=(0,t.useState)([]),[q,H]=(0,t.useState)(null),[U,W]=(0,t.useState)(p()),[Z,G]=(0,t.useState)(""),[Q,X]=(0,t.useState)(""),[Y,$]=(0,t.useState)(""),[ee,eo]=(0,t.useState)(""),[ea,er]=(0,t.useState)(""),[et,en]=(0,t.useState)(""),[ei,es]=(0,t.useState)(p()),[ec,ed]=(0,t.useState)(""),[el,eu]=(0,t.useState)(0),[ep,ev]=(0,t.useState)(""),[eh,e_]=(0,t.useState)(""),[ex,em]=(0,t.useState)(0),[eg,ej]=(0,t.useState)(""),[eS,ef]=(0,t.useState)(!1),[eP,eN]=(0,t.useState)(!1);(0,t.useEffect)(()=>{"Administrador"===e.user.role?(fetch("/api/proveedores").then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>{B(e),v(!1),console.log(e)}).catch(e=>{_(e),v(!1)}),fetch("/api/productos").then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>{J(e),v(!1),console.log(e)}).catch(e=>{_(e),v(!1)})):a.push("/")},[]);let ey=e=>{fetch("/api/inventario/proveedores/".concat(e)).then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>{K(e),console.log(e)}).catch(e=>{_(e),v(!1)})},eb=e=>{let o=M.find(o=>o.prov_id==e);e>0?(W(o.prov_id),G(o.prov_nombre),X(o.prov_direccion),$(o.prov_numero_cont),eo(o.prov_municipio),er(o.prov_estado),en(o.prov_rfc),ey(o.prov_id),E(!0)):(W(p()),G(""),X(""),$(""),eo(""),er(""),en(""),E(!1)),V(!1)},eC=e=>{let o=F.find(o=>o.produc_id==e);e>0?(es(o.produc_id),ed(o.produc_nombre),eu(o.produc_precio_venta),ev(o.produc_parti_fun),e_(o.produc_parti_enlace),A(!0),H(o)):(es(p()),ed(""),eu(0),ev(0),e_(0),A(!1))},ew=()=>{console.log("validar"),""!=Z&&""!=Q&&""!=Y&&""!=ee&&""!=ea&&""!=et?(V(!1),j(!0),m(!1)):V(!0)},eI=()=>{""!=ec&&0!=ex&&0!=el&&0!=eg?(L(!1),j(!1),f(!0)):L(!0)},ek=async()=>{P||((await fetch("/api/proveedores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prov_id:U,prov_nombre:Z,prov_direccion:Q,prov_numero_cont:Y,prov_municipio:ee,prov_estado:ea,prov_rfc:et})})).ok?console.log("Proveedor agregado"):console.log("Error al agregar proveedor")),y?(await fetch("/api/productos/".concat(ei),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({produc_existencias:Number(q.produc_existencias)+Number(eg)})})).ok?console.log("Producto actualizado"):console.log("Error al actualizar producto"):(await fetch("/api/productos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({produc_id:ei,produc_nombre:ec,produc_precio_venta:el,produc_existencias:eg,produc_parti_fun:ep,produc_parti_enlace:eh})})).ok?console.log("Producto agregado"):console.log("Error al agregar producto"),C||((await fetch("/api/inventario",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prov_id:U,produc_id:ei})})).ok?console.log("Proveedor Producto agregado"):console.log("Error al agregar proveedor producto"));try{let e=new Date,o={produc_id:ei,hist_estado:"Entrada",hist_cantidad:eg,hist_precio_ent_sal:ex,hist_hora:(0,u.P4)(),hist_dia:e.toISOString().split("T")[0]};if(!(await fetch("/api/inventario/historial",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)throw Error("Network response was not ok")}catch(e){_(e)}window.location.reload()};return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:s().navigationBar,children:(0,r.jsxs)("h4",{children:[(0,r.jsx)(n.default,{href:"/inventario",className:s().link,children:"Inventario"})," ","\\"," ",(0,r.jsxs)(n.default,{href:"/inventario/nuevo",className:s().link,children:[" ","Nuevo"," "]})]})}),x&&(0,r.jsxs)("div",{className:s().selectProv,children:[(0,r.jsx)("label",{children:"Selecciona un Proveedor Existente: "}),(0,r.jsxs)("select",{className:s().select,onChange:e=>{0===e.target.value?N(!1):(N(!0),eb(e.target.value))},children:[(0,r.jsx)("option",{value:0,children:"--Ninguno--"}),M.map((e,o)=>(0,r.jsx)("option",{value:e.prov_id,children:e.prov_nombre},o))]})]}),(0,r.jsx)("div",{className:s().containerProv,children:x?(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Datos del Proveedor"}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.II,{placeholder:"Nombre del Proveedor",value:Z,onChange:e=>G(e),validation:z,readOnly:O,type:"text"}),(0,r.jsx)(c.II,{placeholder:"Direcci\xf3n",value:Q,onChange:e=>X(e),validation:z,readOnly:O,type:"text"}),(0,r.jsx)(c.II,{placeholder:"Tel\xe9fono",value:Y,onChange:e=>$(e),validation:z,readOnly:O,type:"number"}),(0,r.jsx)(c.II,{placeholder:"Municipio",value:ee,onChange:e=>eo(e),validation:z,readOnly:O,type:"text"}),(0,r.jsx)(c.II,{placeholder:"Estado",value:ea,onChange:e=>er(e),validation:z,readOnly:O,type:"text"}),(0,r.jsx)(c.II,{placeholder:"RFC",value:et,onChange:e=>en(e),validation:z,readOnly:O,type:"text"}),(0,r.jsx)(c.zx,{text:"Aceptar",type:"aceptar",onPress:()=>{ew()}})]}),(0,r.jsx)(c.u_,{title:"Advertencia verificar informaci\xf3n",message:"Se creara el Nuevo Proveedor: ".concat(Z,", ").concat(Q,", ").concat(ee,", ").concat(ea,". Con RFC: ").concat(et),show:eS,handleAccept:()=>{},handleClose:()=>{ef(!1)}})]}):(0,r.jsxs)("div",{className:s().overViewProv,children:[(0,r.jsxs)("p",{children:[Z," a RFC: ",et,", Tel. ",Y,", Direcci\xf3n:"," ",Q,", ",ee,", ",ea,"."," "]}),(0,r.jsx)(c.zx,{text:"Cambiar",type:"aceptar",onPress:()=>{j(!1),m(!0)}})]})}),g?(0,r.jsxs)("div",{className:s().selectProv,children:[(0,r.jsx)("label",{children:"Seleccionar producto relacionado: "}),(0,r.jsxs)("select",{className:s().select,onChange:e=>{eC(e.target.value),0!=e.target.value?(b(!0),w(!0)):(b(!1),w(!1))},disabled:I,children:[(0,r.jsx)("option",{value:0,children:"--Ninguno--"}),R.map((e,o)=>(0,r.jsx)("option",{value:e.produc_id,children:e.produc_nombre},o))]}),(0,r.jsx)("label",{children:"Seleccionar producto existente: "}),(0,r.jsxs)("select",{className:s().select,onChange:e=>{eC(e.target.value),0!=e.target.value?(k(!0),b(!0)):(b(!1),k(!1))},disabled:C,children:[(0,r.jsx)("option",{value:0,children:"--Ninguno--"}),F.map((e,o)=>(0,r.jsx)("option",{value:e.produc_id,children:e.produc_nombre},o))]})]}):(0,r.jsx)(r.Fragment,{children:x?(0,r.jsx)("div",{className:s().selectProduc,children:(0,r.jsx)("p",{children:"Seleccionar un Proveedor primero"})}):(0,r.jsxs)("div",{className:s().overViewProduc,children:[(0,r.jsxs)("p",{children:["Pedido de ",eg," ",ec," comprado a ",ex," ","para vender a ",el]}),(0,r.jsx)(c.zx,{text:"Cambiar",type:"aceptar",onPress:()=>{j(!0),f(!1)}})]})}),g&&(0,r.jsxs)("div",{className:s().formProduct,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Datos del Producto"}),(0,r.jsx)(c.II,{placeholder:"Nombre del Producto",value:ec,onChange:e=>{ed(e)},type:"text",validation:D,readOnly:T}),(0,r.jsx)(c.II,{placeholder:"Participacion Fundaci\xf3n",value:ep,onChange:e=>{ev(Number(e))},type:"number",validation:D,readOnly:T}),(0,r.jsx)(c.II,{placeholder:"Participacion Enlace",value:eh,onChange:e=>{e_(Number(e))},type:"number",validation:D,readOnly:T})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Datos de adquicicion"}),(0,r.jsx)(c.II,{placeholder:"Precio de Compra",value:ex,onChange:e=>{em(Number(e))},type:"number",validation:D}),(0,r.jsx)(c.II,{placeholder:"Precio de Venta a Publico",value:el,onChange:e=>{eu(Number(e))},type:"number",validation:D,readOnly:T}),(0,r.jsx)(c.II,{placeholder:"Cantidad Suministrada",value:eg,onChange:e=>{ej(Number(e))},type:"number",validation:D})]}),(0,r.jsx)(c.zx,{text:"Aceptar",type:"aceptar",onPress:()=>{eI()}})]}),S&&(0,r.jsxs)("div",{className:s().formComplete,children:[(0,r.jsx)("p",{children:"Listo para agregar una nueva entrada al inventario"}),(0,r.jsx)(c.zx,{text:"Aceptar",type:"cancelar",onPress:()=>{eN(!0)}})]}),(0,r.jsx)(c.u_,{show:eP,title:"Nuevo Producto",message:"Se creara un nuevo producto",handleClose:()=>{eN(!1)},handleAccept:()=>{ek()}})]})}},8116:function(e,o,a){"use strict";a.d(o,{Z:function(){return i}});var r=a(7437);a(2265);var t=a(6065),n=a.n(t);function i(){return(0,r.jsxs)("div",{className:n().contenedor,children:[(0,r.jsx)("div",{className:n().cuadrado1}),(0,r.jsx)("div",{className:n().cuadrado2})]})}},91:function(e){e.exports={navigationBar:"page_navigationBar___rNRA",link:"page_link__3NoLb",containerProv:"page_containerProv__gKtEK",selectProv:"page_selectProv__Uou8W",select:"page_select__9KWM6",overViewProv:"page_overViewProv__ecxB_",overViewProduc:"page_overViewProduc__qkPmw",selectProduc:"page_selectProduc__vBM1_",formProduct:"page_formProduct__Hn_Aw",formComplete:"page_formComplete__jIoMv"}},6065:function(e){e.exports={cuadrado1:"LoadingScreen_cuadrado1__7A200",cuadrado2:"LoadingScreen_cuadrado2__NNxpH",moverCuadrado1:"LoadingScreen_moverCuadrado1__8i1jV",moverCuadrado2:"LoadingScreen_moverCuadrado2__pz35P"}}},function(e){e.O(0,[9947,1316,7123,8153,6307,7648,4868,2971,2117,1744],function(){return e(e.s=910)}),_N_E=e.O()}]);